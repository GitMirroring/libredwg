{"version":1,"ops":[{"type":1,"author":{"id":"2bf6b52bc0dae630473aacf6f181bed209a5a6b2"},"timestamp":1571712254,"metadata":{"github-id":"MDU6SXNzdWU1MTAzOTg3ODA=","github-url":"https://github.com/LibreDWG/libredwg/issues/159","origin":"github"},"title":"heapoverflow in dwg2svg2","message":"AddressSanitizer output:\n\n```\nxxx@secdive-public-dev:~/workplace/asan/libredwg-0.9.2376/examples$ ./dwg2svg2 heapoverflow.dwg \n=================================================================\n==144878== ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60440000fef8 at pc 0x7feac351c84e bp 0x7fff36a49360 sp 0x7fff36a49358\nWRITE of size 1 at 0x60440000fef8 thread T0\n    #0 0x7feac351c84d (/home/xxx/workplace/asan/libredwg-0.9.2376/src/.libs/libredwg.so.0.0.9+0x11d84d)\n    #1 0x7feac35bebcd (/home/xxx/workplace/asan/libredwg-0.9.2376/src/.libs/libredwg.so.0.0.9+0x1bfbcd)\n    #2 0x7feac35bfbfa (/home/xxx/workplace/asan/libredwg-0.9.2376/src/.libs/libredwg.so.0.0.9+0x1c0bfa)\n    #3 0x7feac35ded35 (/home/xxx/workplace/asan/libredwg-0.9.2376/src/.libs/libredwg.so.0.0.9+0x1dfd35)\n    #4 0x7feac3520dda (/home/xxx/workplace/asan/libredwg-0.9.2376/src/.libs/libredwg.so.0.0.9+0x121dda)\n    #5 0x7feac350be45 (/home/xxx/workplace/asan/libredwg-0.9.2376/src/.libs/libredwg.so.0.0.9+0x10ce45)\n    #6 0x40196b (/home/xxx/workplace/asan/libredwg-0.9.2376/examples/.libs/lt-dwg2svg2+0x40196b)\n    #7 0x403f4c (/home/xxx/workplace/asan/libredwg-0.9.2376/examples/.libs/lt-dwg2svg2+0x403f4c)\n    #8 0x7feac2d51f44 (/lib/x86_64-linux-gnu/libc-2.19.so+0x21f44)\n    #9 0x4016d8 (/home/xxx/workplace/asan/libredwg-0.9.2376/examples/.libs/lt-dwg2svg2+0x4016d8)\n0x60440000fef8 is located 0 bytes to the right of 1144-byte region [0x60440000fa80,0x60440000fef8)\nallocated by thread T0 here:\n    #0 0x7feac484a4e5 (/usr/lib/x86_64-linux-gnu/libasan.so.0.0.0+0x154e5)\n    #1 0x7feac35bfb4b (/home/xxx/workplace/asan/libredwg-0.9.2376/src/.libs/libredwg.so.0.0.9+0x1c0b4b)\n    #2 0x7feac35ded35 (/home/xxx/workplace/asan/libredwg-0.9.2376/src/.libs/libredwg.so.0.0.9+0x1dfd35)\n    #3 0x7feac3520dda (/home/xxx/workplace/asan/libredwg-0.9.2376/src/.libs/libredwg.so.0.0.9+0x121dda)\n    #4 0x7feac350be45 (/home/xxx/workplace/asan/libredwg-0.9.2376/src/.libs/libredwg.so.0.0.9+0x10ce45)\n    #5 0x40196b (/home/xxx/workplace/asan/libredwg-0.9.2376/examples/.libs/lt-dwg2svg2+0x40196b)\n    #6 0x403f4c (/home/xxx/workplace/asan/libredwg-0.9.2376/examples/.libs/lt-dwg2svg2+0x403f4c)\n    #7 0x7feac2d51f44 (/lib/x86_64-linux-gnu/libc-2.19.so+0x21f44)\nShadow bytes around the buggy address:\n  0x0c08ffff9f80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c08ffff9f90: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c08ffff9fa0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c08ffff9fb0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c08ffff9fc0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n=\u003e0x0c08ffff9fd0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00[fa]\n  0x0c08ffff9fe0:fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c08ffff9ff0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c08ffffa000: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c08ffffa010: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c08ffffa020: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07 \n  Heap left redzone:     fa\n  Heap righ redzone:     fb\n  Freed Heap region:     fd\n  Stack left redzone:    f1\n  Stack mid redzone:     f2\n  Stack right redzone:   f3\n  Stack partial redzone: f4\n  Stack after return:    f5\n  Stack use after scope: f8\n  Global redzone:        f9\n  Global init order:     f6\n  Poisoned by user:      f7\n  ASan internal:         fe\n==144878== ABORTING\n```\n\npoc\n```\nhttps://github.com/hac425xxx/fuzzdata/blob/master/heapoverflow.dwg\n```","files":null}]}