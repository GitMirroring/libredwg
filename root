{"version":1,"ops":[{"type":1,"author":{"id":"1b887fa524848596ba06633285df999b53626bc3"},"timestamp":1564270748,"metadata":{"github-id":"MDU6SXNzdWU0NzM2ODgxMTM=","github-url":"https://github.com/LibreDWG/libredwg/issues/126","origin":"github"},"title":"Several bugs found by fuzzing","message":"Hi,\nAfter fuzzing libredwg, I found the following bugs on the latest commit 959984b on master.\nCommand: dwg2SVG $PoC\n\n### 1. Invalid free in decode.c:2289\nPoC: https://github.com/strongcourage/PoCs/blob/master/libredwg_959984b/PoC_af_decode.c:2289\nASAN says:\n~~~\n==20736==ERROR: AddressSanitizer: attempting free on address which was not malloc()-ed: 0x7f3e63c329f5 in thread T0\n    #0 0x7f3e62c2932a in __interceptor_free (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x9832a)\n    #1 0x4973ad in read_2004_section_handles ../../src/decode.c:2289\n    #2 0x4a1f6d in decode_R2004 ../../src/decode.c:2425\n    #3 0x414259 in dwg_decode ../../src/decode.c:221\n    #4 0x4046b8 in dwg_read_file ../../src/dwg.c:193\n    #5 0x403767 in main ../../programs/dwg2SVG.c:376\n    #6 0x7f3e624de82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n    #7 0x401948 in _start (/home/dungnguyen/PoCs/libredwg_959984b/dwg2SVG-asan+0x401948)\n~~~\nThanks,\nManh Dung","files":null}]}