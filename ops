{"version":1,"ops":[{"type":1,"author":{"id":"382b9e8c398178f9ea0a60f00ae88550626e36d5"},"timestamp":1572872004,"metadata":{"github-id":"MDU6SXNzdWU1MTcxMzE5MTE=","github-url":"https://github.com/LibreDWG/libredwg/issues/166","origin":"github"},"title":"Odd buffer output","message":"Hi,\n\nI'm trying to run the dwglayers.exe app with some DWG files.\nIt works just fine when called via BAT command but when called from a .NET app using Process class it works sometimes and fails to get information from some dwg files.\n\n`\nProcessStartInfo objStartInfo = new ProcessStartInfo();\n            objStartInfo.FileName = \"dwglayers.exe\";\n            objStartInfo.Arguments = string.Format(\"\\\"{0}\\\"\", \"MyDwgFile.dwg\");\n            objStartInfo.RedirectStandardOutput = true;\n            objStartInfo.UseShellExecute = false;\n            objStartInfo.CreateNoWindow = true;\n\n            try\n            {\n                List\u003cstring\u003e lstResult = new List\u003cstring\u003e();\n                using (var objProcess = new Process())\n                {\n                    objProcess.EnableRaisingEvents = true;\n                    objProcess.StartInfo = objStartInfo;\n                    objProcess.OutputDataReceived += (sender, e) =\u003e\n                    {\n                        if (string.IsNullOrWhiteSpace(e.Data))\n                            return;\n\n                        if (e.Data.Trim() == \"0\")\n                            return;\n\n                        if (!lstResult.Any(sItem =\u003e sItem.Equals(e.Data, StringComparison.InvariantCultureIgnoreCase)))\n                            lstResult.Add(e.Data);\n                    };\n\n                    objProcess.Start();\n                    objProcess.BeginOutputReadLine();\n\n                    objProcess.WaitForExit();\n                }\n            }\n            catch (Exception excError)\n            {\n            }\n`\n\nIt seems dwglayers.exe doesn't fill the output before exiting (or maybe doesn't flush the output properly).\n\nThe odd behavior is that for some drawings this code works just fine.\nI'm attaching a DWG that can be successfully run via BAT but can't with this code.\n\nIt should list the following layers:\n0\nAFUWS-P\nAFUWS-P-TN\n\nThank you.\n[MyDwgFile.dwg.zip](https://github.com/LibreDWG/libredwg/files/3804033/MyDwgFile.dwg.zip)","files":null}]}