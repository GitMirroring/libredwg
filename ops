{"version":1,"ops":[{"type":6,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1577773083,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdDMzMTE4ODEzNg=="},"target":"7f8b5ad5bc65f840da2c7846c6b447ae7c9ecda10fbfc170251763ee6b1aff5e","message":"Hi,\nI got some bugs, and I tested on master branch and version **0.9.3**. There are **3 heap overflow**, **2 NULL pointer deference**, **1 denial of service**, **1 stack overflow** (this bug causes memory leak in master branch) in that.\nCompile with **ASAN** and use **dwgrewrite** to repro that.\nHear are some details:","files":null},{"type":3,"author":{"id":"62f2fa164ca23ed14e237c3c802be09d069144f8"},"timestamp":1577772472,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDU2OTg3MDkwNA==","github-url":"https://github.com/LibreDWG/libredwg/issues/178#issuecomment-569870904"},"message":"**file:heap_overflow1**\n**1. Crafted input will lead to heap-buffer-overflow in /src/bits.c:1370 **\nASAN report:\n```\n==97792==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60300000e1b5 at pc 0x7ff0165d944e bp 0x7ffc703987e0 sp 0x7ffc703987d0\nREAD of size 1 at 0x60300000e1b5 thread T0\n    #0 0x7ff0165d944d in bit_write_TF /home/sv/Documents/libredwg-master/src/bits.c:1370\n    #1 0x7ff0173a08d3 in dwg_encode_eed_data /home/sv/Documents/libredwg-master/src/encode.c:2069\n    #2 0x7ff0173a1e49 in dwg_encode_eed /home/sv/Documents/libredwg-master/src/encode.c:2178\n    #3 0x7ff0173a2ccf in dwg_encode_entity /home/sv/Documents/libredwg-master/src/encode.c:2257\n    #4 0x7ff0172751f0 in dwg_encode_MTEXT /home/sv/Documents/libredwg-master/src/dwg.spec:2225\n    #5 0x7ff01739ea00 in dwg_encode_add_object /home/sv/Documents/libredwg-master/src/encode.c:1808\n    #6 0x7ff01721b341 in dwg_encode /home/sv/Documents/libredwg-master/src/encode.c:1191\n    #7 0x7ff0165c72ec in dwg_write_file /home/sv/Documents/libredwg-master/src/dwg.c:350\n    #8 0x555c7778444e in main /home/sv/Documents/libredwg-master/programs/dwgrewrite.c:286\n    #9 0x7ff015cdab96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)\n    #10 0x555c77783149 in _start (/home/sv/output3/bin/dwgrewrite+0x2149)\n\n0x60300000e1b5 is located 0 bytes to the right of 21-byte region [0x60300000e1a0,0x60300000e1b5)\nallocated by thread T0 here:\n    #0 0x7ff0179eed38 in __interceptor_calloc (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xded38)\n    #1 0x7ff0166665a2 in dwg_decode_eed /home/sv/Documents/libredwg-master/src/decode.c:3242\n    #2 0x7ff016668ebf in dwg_decode_entity /home/sv/Documents/libredwg-master/src/decode.c:3550\n    #3 0x7ff0167f7c56 in dwg_decode_MTEXT_private /home/sv/Documents/libredwg-master/src/dwg.spec:2225\n    #4 0x7ff0167f78fa in dwg_decode_MTEXT /home/sv/Documents/libredwg-master/src/dwg.spec:2225\n    #5 0x7ff016a778ca in dwg_decode_add_object /home/sv/Documents/libredwg-master/src/decode.c:4799\n    #6 0x7ff01663bc5d in decode_R13_R2000 /home/sv/Documents/libredwg-master/src/decode.c:1240\n    #7 0x7ff0165ddb7e in dwg_decode /home/sv/Documents/libredwg-master/src/decode.c:239\n    #8 0x7ff0165c5a65 in dwg_read_file /home/sv/Documents/libredwg-master/src/dwg.c:206\n    #9 0x555c77783ffb in main /home/sv/Documents/libredwg-master/programs/dwgrewrite.c:226\n    #10 0x7ff015cdab96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow /home/sv/Documents/libredwg-master/src/bits.c:1370 in bit_write_TF\nShadow bytes around the buggy address:\n  0x0c067fff9be0: 00 00 00 00 fa fa 00 00 00 00 fa fa 00 00 00 00\n  0x0c067fff9bf0: fa fa 00 00 00 00 fa fa 00 00 00 00 fa fa 00 00\n  0x0c067fff9c00: 00 00 fa fa 00 00 00 00 fa fa 00 00 00 00 fa fa\n  0x0c067fff9c10: 00 00 00 00 fa fa 00 00 00 00 fa fa 00 00 00 00\n  0x0c067fff9c20: fa fa 00 00 00 00 fa fa 00 00 00 00 fa fa 00 00\n=\u003e0x0c067fff9c30: 00 01 fa fa 00 00[05]fa fa fa 00 00 00 00 fa fa\n  0x0c067fff9c40: 00 00 00 00 fa fa 00 00 00 00 fa fa 00 00 00 00\n  0x0c067fff9c50: fa fa 00 00 00 00 fa fa 00 00 00 00 fa fa 00 00\n  0x0c067fff9c60: 00 00 fa fa 00 00 00 00 fa fa 00 00 00 00 fa fa\n  0x0c067fff9c70: 00 00 00 00 fa fa 00 00 00 00 fa fa 00 00 03 fa\n  0x0c067fff9c80: fa fa 00 00 00 00 fa fa 00 00 00 00 fa fa 00 00\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07 \n  Heap left redzone:       fa\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n```","files":null},{"type":6,"author":{"id":"62f2fa164ca23ed14e237c3c802be09d069144f8"},"timestamp":1577772472,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdDMzMTE4NjM2Ng=="},"target":"0187e0cfc8e531622d84db55169f746742dd1c54f7d333c418a487f8473c1a16","message":"**file:heap_overflow1**\n**1. Crafted input will lead to heap-buffer-overflow in /src/bits.c:1370**\nASAN report:\n```\n==97792==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60300000e1b5 at pc 0x7ff0165d944e bp 0x7ffc703987e0 sp 0x7ffc703987d0\nREAD of size 1 at 0x60300000e1b5 thread T0\n    #0 0x7ff0165d944d in bit_write_TF /home/sv/Documents/libredwg-master/src/bits.c:1370\n    #1 0x7ff0173a08d3 in dwg_encode_eed_data /home/sv/Documents/libredwg-master/src/encode.c:2069\n    #2 0x7ff0173a1e49 in dwg_encode_eed /home/sv/Documents/libredwg-master/src/encode.c:2178\n    #3 0x7ff0173a2ccf in dwg_encode_entity /home/sv/Documents/libredwg-master/src/encode.c:2257\n    #4 0x7ff0172751f0 in dwg_encode_MTEXT /home/sv/Documents/libredwg-master/src/dwg.spec:2225\n    #5 0x7ff01739ea00 in dwg_encode_add_object /home/sv/Documents/libredwg-master/src/encode.c:1808\n    #6 0x7ff01721b341 in dwg_encode /home/sv/Documents/libredwg-master/src/encode.c:1191\n    #7 0x7ff0165c72ec in dwg_write_file /home/sv/Documents/libredwg-master/src/dwg.c:350\n    #8 0x555c7778444e in main /home/sv/Documents/libredwg-master/programs/dwgrewrite.c:286\n    #9 0x7ff015cdab96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)\n    #10 0x555c77783149 in _start (/home/sv/output3/bin/dwgrewrite+0x2149)\n\n0x60300000e1b5 is located 0 bytes to the right of 21-byte region [0x60300000e1a0,0x60300000e1b5)\nallocated by thread T0 here:\n    #0 0x7ff0179eed38 in __interceptor_calloc (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xded38)\n    #1 0x7ff0166665a2 in dwg_decode_eed /home/sv/Documents/libredwg-master/src/decode.c:3242\n    #2 0x7ff016668ebf in dwg_decode_entity /home/sv/Documents/libredwg-master/src/decode.c:3550\n    #3 0x7ff0167f7c56 in dwg_decode_MTEXT_private /home/sv/Documents/libredwg-master/src/dwg.spec:2225\n    #4 0x7ff0167f78fa in dwg_decode_MTEXT /home/sv/Documents/libredwg-master/src/dwg.spec:2225\n    #5 0x7ff016a778ca in dwg_decode_add_object /home/sv/Documents/libredwg-master/src/decode.c:4799\n    #6 0x7ff01663bc5d in decode_R13_R2000 /home/sv/Documents/libredwg-master/src/decode.c:1240\n    #7 0x7ff0165ddb7e in dwg_decode /home/sv/Documents/libredwg-master/src/decode.c:239\n    #8 0x7ff0165c5a65 in dwg_read_file /home/sv/Documents/libredwg-master/src/dwg.c:206\n    #9 0x555c77783ffb in main /home/sv/Documents/libredwg-master/programs/dwgrewrite.c:226\n    #10 0x7ff015cdab96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow /home/sv/Documents/libredwg-master/src/bits.c:1370 in bit_write_TF\nShadow bytes around the buggy address:\n  0x0c067fff9be0: 00 00 00 00 fa fa 00 00 00 00 fa fa 00 00 00 00\n  0x0c067fff9bf0: fa fa 00 00 00 00 fa fa 00 00 00 00 fa fa 00 00\n  0x0c067fff9c00: 00 00 fa fa 00 00 00 00 fa fa 00 00 00 00 fa fa\n  0x0c067fff9c10: 00 00 00 00 fa fa 00 00 00 00 fa fa 00 00 00 00\n  0x0c067fff9c20: fa fa 00 00 00 00 fa fa 00 00 00 00 fa fa 00 00\n=\u003e0x0c067fff9c30: 00 01 fa fa 00 00[05]fa fa fa 00 00 00 00 fa fa\n  0x0c067fff9c40: 00 00 00 00 fa fa 00 00 00 00 fa fa 00 00 00 00\n  0x0c067fff9c50: fa fa 00 00 00 00 fa fa 00 00 00 00 fa fa 00 00\n  0x0c067fff9c60: 00 00 fa fa 00 00 00 00 fa fa 00 00 00 00 fa fa\n  0x0c067fff9c70: 00 00 00 00 fa fa 00 00 00 00 fa fa 00 00 03 fa\n  0x0c067fff9c80: fa fa 00 00 00 00 fa fa 00 00 00 00 fa fa 00 00\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07 \n  Heap left redzone:       fa\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n```","files":null},{"type":3,"author":{"id":"62f2fa164ca23ed14e237c3c802be09d069144f8"},"timestamp":1577772591,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDU2OTg3MTEyMg==","github-url":"https://github.com/LibreDWG/libredwg/issues/178#issuecomment-569871122"},"message":"**file:heap_overflow2\n1. Crafted input will lead to heap-buffer-overflow in src/common_entity_data.spec:175**\nASAN report:\n```\n==97787==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x608000008f18 at pc 0x7f98cbbefd57 bp 0x7ffc08008710 sp 0x7ffc08008700\nREAD of size 8 at 0x608000008f18 thread T0\n    #0 0x7f98cbbefd56 in dwg_encode_entity /home/sv/Documents/libredwg-master/src/common_entity_data.spec:175\n    #1 0x7f98cbbb9197 in dwg_encode_UNKNOWN_ENT /home/sv/Documents/libredwg-master/src/dwg.spec:5928\n    #2 0x7f98cbbea541 in dwg_encode_add_object /home/sv/Documents/libredwg-master/src/encode.c:1964\n    #3 0x7f98cba66341 in dwg_encode /home/sv/Documents/libredwg-master/src/encode.c:1191\n    #4 0x7f98cae122ec in dwg_write_file /home/sv/Documents/libredwg-master/src/dwg.c:350\n    #5 0x55cfb2b8144e in main /home/sv/Documents/libredwg-master/programs/dwgrewrite.c:286\n    #6 0x7f98ca525b96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)\n    #7 0x55cfb2b80149 in _start (/home/sv/output3/bin/dwgrewrite+0x2149)\n\n0x608000008f18 is located 8 bytes to the left of 88-byte region [0x608000008f20,0x608000008f78)\nallocated by thread T0 here:\n    #0 0x7f98cc239d38 in __interceptor_calloc (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xded38)\n    #1 0x7f98cb268af4 in dwg_add_UNKNOWN_OBJ /home/sv/Documents/libredwg-master/src/dwg.spec:5934\n    #2 0x7f98cb268f0e in dwg_decode_UNKNOWN_OBJ /home/sv/Documents/libredwg-master/src/dwg.spec:5934\n    #3 0x7f98cb2c4aac in dwg_decode_add_object /home/sv/Documents/libredwg-master/src/decode.c:5019\n    #4 0x7f98cae86c5d in decode_R13_R2000 /home/sv/Documents/libredwg-master/src/decode.c:1240\n    #5 0x7f98cae28b7e in dwg_decode /home/sv/Documents/libredwg-master/src/decode.c:239\n    #6 0x7f98cae10a65 in dwg_read_file /home/sv/Documents/libredwg-master/src/dwg.c:206\n    #7 0x55cfb2b80ffb in main /home/sv/Documents/libredwg-master/programs/dwgrewrite.c:226\n    #8 0x7f98ca525b96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow /home/sv/Documents/libredwg-master/src/common_entity_data.spec:175 in dwg_encode_entity\nShadow bytes around the buggy address:\n  0x0c107fff9190: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa\n  0x0c107fff91a0: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa\n  0x0c107fff91b0: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa\n  0x0c107fff91c0: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa\n  0x0c107fff91d0: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa\n=\u003e0x0c107fff91e0: fa fa fa[fa]00 00 00 00 00 00 00 00 00 00 00 fa\n  0x0c107fff91f0: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa\n  0x0c107fff9200: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa\n  0x0c107fff9210: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa\n  0x0c107fff9220: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa\n  0x0c107fff9230: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07 \n  Heap left redzone:       fa\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n```","files":null},{"type":6,"author":{"id":"62f2fa164ca23ed14e237c3c802be09d069144f8"},"timestamp":1577772591,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdDMzMTE4Njc1MQ=="},"target":"c1ddd09068af6f1f9521e670788e7c8e22915fce728833b85ee8a24da60740b5","message":"**file:heap_overflow2**\n**1. Crafted input will lead to heap-buffer-overflow in src/common_entity_data.spec:175**\n\nASAN report:\n```\n==97787==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x608000008f18 at pc 0x7f98cbbefd57 bp 0x7ffc08008710 sp 0x7ffc08008700\nREAD of size 8 at 0x608000008f18 thread T0\n    #0 0x7f98cbbefd56 in dwg_encode_entity /home/sv/Documents/libredwg-master/src/common_entity_data.spec:175\n    #1 0x7f98cbbb9197 in dwg_encode_UNKNOWN_ENT /home/sv/Documents/libredwg-master/src/dwg.spec:5928\n    #2 0x7f98cbbea541 in dwg_encode_add_object /home/sv/Documents/libredwg-master/src/encode.c:1964\n    #3 0x7f98cba66341 in dwg_encode /home/sv/Documents/libredwg-master/src/encode.c:1191\n    #4 0x7f98cae122ec in dwg_write_file /home/sv/Documents/libredwg-master/src/dwg.c:350\n    #5 0x55cfb2b8144e in main /home/sv/Documents/libredwg-master/programs/dwgrewrite.c:286\n    #6 0x7f98ca525b96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)\n    #7 0x55cfb2b80149 in _start (/home/sv/output3/bin/dwgrewrite+0x2149)\n\n0x608000008f18 is located 8 bytes to the left of 88-byte region [0x608000008f20,0x608000008f78)\nallocated by thread T0 here:\n    #0 0x7f98cc239d38 in __interceptor_calloc (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xded38)\n    #1 0x7f98cb268af4 in dwg_add_UNKNOWN_OBJ /home/sv/Documents/libredwg-master/src/dwg.spec:5934\n    #2 0x7f98cb268f0e in dwg_decode_UNKNOWN_OBJ /home/sv/Documents/libredwg-master/src/dwg.spec:5934\n    #3 0x7f98cb2c4aac in dwg_decode_add_object /home/sv/Documents/libredwg-master/src/decode.c:5019\n    #4 0x7f98cae86c5d in decode_R13_R2000 /home/sv/Documents/libredwg-master/src/decode.c:1240\n    #5 0x7f98cae28b7e in dwg_decode /home/sv/Documents/libredwg-master/src/decode.c:239\n    #6 0x7f98cae10a65 in dwg_read_file /home/sv/Documents/libredwg-master/src/dwg.c:206\n    #7 0x55cfb2b80ffb in main /home/sv/Documents/libredwg-master/programs/dwgrewrite.c:226\n    #8 0x7f98ca525b96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow /home/sv/Documents/libredwg-master/src/common_entity_data.spec:175 in dwg_encode_entity\nShadow bytes around the buggy address:\n  0x0c107fff9190: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa\n  0x0c107fff91a0: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa\n  0x0c107fff91b0: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa\n  0x0c107fff91c0: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa\n  0x0c107fff91d0: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa\n=\u003e0x0c107fff91e0: fa fa fa[fa]00 00 00 00 00 00 00 00 00 00 00 fa\n  0x0c107fff91f0: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa\n  0x0c107fff9200: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa\n  0x0c107fff9210: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa\n  0x0c107fff9220: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa\n  0x0c107fff9230: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07 \n  Heap left redzone:       fa\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n```","files":null},{"type":6,"author":{"id":"62f2fa164ca23ed14e237c3c802be09d069144f8"},"timestamp":1577772604,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdDMzMTE4Njc5OA=="},"target":"c1ddd09068af6f1f9521e670788e7c8e22915fce728833b85ee8a24da60740b5","message":"**file:heap_overflow2**\n**2. Crafted input will lead to heap-buffer-overflow in src/common_entity_data.spec:175**\n\nASAN report:\n```\n==97787==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x608000008f18 at pc 0x7f98cbbefd57 bp 0x7ffc08008710 sp 0x7ffc08008700\nREAD of size 8 at 0x608000008f18 thread T0\n    #0 0x7f98cbbefd56 in dwg_encode_entity /home/sv/Documents/libredwg-master/src/common_entity_data.spec:175\n    #1 0x7f98cbbb9197 in dwg_encode_UNKNOWN_ENT /home/sv/Documents/libredwg-master/src/dwg.spec:5928\n    #2 0x7f98cbbea541 in dwg_encode_add_object /home/sv/Documents/libredwg-master/src/encode.c:1964\n    #3 0x7f98cba66341 in dwg_encode /home/sv/Documents/libredwg-master/src/encode.c:1191\n    #4 0x7f98cae122ec in dwg_write_file /home/sv/Documents/libredwg-master/src/dwg.c:350\n    #5 0x55cfb2b8144e in main /home/sv/Documents/libredwg-master/programs/dwgrewrite.c:286\n    #6 0x7f98ca525b96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)\n    #7 0x55cfb2b80149 in _start (/home/sv/output3/bin/dwgrewrite+0x2149)\n\n0x608000008f18 is located 8 bytes to the left of 88-byte region [0x608000008f20,0x608000008f78)\nallocated by thread T0 here:\n    #0 0x7f98cc239d38 in __interceptor_calloc (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xded38)\n    #1 0x7f98cb268af4 in dwg_add_UNKNOWN_OBJ /home/sv/Documents/libredwg-master/src/dwg.spec:5934\n    #2 0x7f98cb268f0e in dwg_decode_UNKNOWN_OBJ /home/sv/Documents/libredwg-master/src/dwg.spec:5934\n    #3 0x7f98cb2c4aac in dwg_decode_add_object /home/sv/Documents/libredwg-master/src/decode.c:5019\n    #4 0x7f98cae86c5d in decode_R13_R2000 /home/sv/Documents/libredwg-master/src/decode.c:1240\n    #5 0x7f98cae28b7e in dwg_decode /home/sv/Documents/libredwg-master/src/decode.c:239\n    #6 0x7f98cae10a65 in dwg_read_file /home/sv/Documents/libredwg-master/src/dwg.c:206\n    #7 0x55cfb2b80ffb in main /home/sv/Documents/libredwg-master/programs/dwgrewrite.c:226\n    #8 0x7f98ca525b96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow /home/sv/Documents/libredwg-master/src/common_entity_data.spec:175 in dwg_encode_entity\nShadow bytes around the buggy address:\n  0x0c107fff9190: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa\n  0x0c107fff91a0: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa\n  0x0c107fff91b0: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa\n  0x0c107fff91c0: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa\n  0x0c107fff91d0: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa\n=\u003e0x0c107fff91e0: fa fa fa[fa]00 00 00 00 00 00 00 00 00 00 00 fa\n  0x0c107fff91f0: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa\n  0x0c107fff9200: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa\n  0x0c107fff9210: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa\n  0x0c107fff9220: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa\n  0x0c107fff9230: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07 \n  Heap left redzone:       fa\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n```","files":null},{"type":3,"author":{"id":"62f2fa164ca23ed14e237c3c802be09d069144f8"},"timestamp":1577772681,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDU2OTg3MTM2Mw==","github-url":"https://github.com/LibreDWG/libredwg/issues/178#issuecomment-569871363"},"message":"**file:heap_overflow3**\n**3. Crafted input will lead to heap-buffer-overflow in src/decode.c:1339**\nASAN report:\n```\n==97993==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x6130000001b0 at pc 0x7f8fbb2298e5 bp 0x7ffec24076a0 sp 0x7ffec2407690\nREAD of size 8 at 0x6130000001b0 thread T0\n    #0 0x7f8fbb2298e4 in decode_R13_R2000 /home/sv/Documents/libredwg-master/src/decode.c:1339\n    #1 0x7f8fbb1cab7e in dwg_decode /home/sv/Documents/libredwg-master/src/decode.c:239\n    #2 0x7f8fbb1b2a65 in dwg_read_file /home/sv/Documents/libredwg-master/src/dwg.c:206\n    #3 0x55edd3fc9ffb in main /home/sv/Documents/libredwg-master/programs/dwgrewrite.c:226\n    #4 0x7f8fba8c7b96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)\n    #5 0x55edd3fc9149 in _start (/home/sv/output3/bin/dwgrewrite+0x2149)\n\n0x6130000001b0 is located 8 bytes to the right of 360-byte region [0x613000000040,0x6130000001a8)\nallocated by thread T0 here:\n    #0 0x7f8fbc5dbd38 in __interceptor_calloc (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xded38)\n    #1 0x7f8fbb219d8f in decode_R13_R2000 /home/sv/Documents/libredwg-master/src/decode.c:885\n    #2 0x7f8fbb1cab7e in dwg_decode /home/sv/Documents/libredwg-master/src/decode.c:239\n    #3 0x7f8fbb1b2a65 in dwg_read_file /home/sv/Documents/libredwg-master/src/dwg.c:206\n    #4 0x55edd3fc9ffb in main /home/sv/Documents/libredwg-master/programs/dwgrewrite.c:226\n    #5 0x7f8fba8c7b96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow /home/sv/Documents/libredwg-master/src/decode.c:1339 in decode_R13_R2000\nShadow bytes around the buggy address:\n  0x0c267fff7fe0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c267fff7ff0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c267fff8000: fa fa fa fa fa fa fa fa 00 00 00 00 00 00 00 00\n  0x0c267fff8010: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c267fff8020: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n=\u003e0x0c267fff8030: 00 00 00 00 00 fa[fa]fa fa fa fa fa fa fa fa fa\n  0x0c267fff8040: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\n  0x0c267fff8050: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\n  0x0c267fff8060: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\n  0x0c267fff8070: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd\n  0x0c267fff8080: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07 \n  Heap left redzone:       fa\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n```","files":null},{"type":3,"author":{"id":"62f2fa164ca23ed14e237c3c802be09d069144f8"},"timestamp":1577772775,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDU2OTg3MTU3Ng==","github-url":"https://github.com/LibreDWG/libredwg/issues/178#issuecomment-569871576"},"message":"**file:null_pointer1**\n**4. There is a NULL pointer dereference in the function /src/dwg.spec:4117**\nASAN report\n```\n==97830==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x7fd08188a801 bp 0x7ffdac74f740 sp 0x7ffdac74f6e0 T0)\n==97830==The signal is caused by a READ memory access.\n==97830==Hint: address points to the zero page.\n    #0 0x7fd08188a800 in dwg_encode_LWPOLYLINE /home/sv/Documents/libredwg-master/src/dwg.spec:4117\n    #1 0x7fd081916d87 in dwg_encode_add_object /home/sv/Documents/libredwg-master/src/encode.c:1897\n    #2 0x7fd081793341 in dwg_encode /home/sv/Documents/libredwg-master/src/encode.c:1191\n    #3 0x7fd080b3f2ec in dwg_write_file /home/sv/Documents/libredwg-master/src/dwg.c:350\n    #4 0x55dc68f1944e in main /home/sv/Documents/libredwg-master/programs/dwgrewrite.c:286\n    #5 0x7fd080252b96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)\n    #6 0x55dc68f18149 in _start (/home/sv/output3/bin/dwgrewrite+0x2149)\n\nAddressSanitizer can not provide additional info.\nSUMMARY: AddressSanitizer: SEGV /home/sv/Documents/libredwg-master/src/dwg.spec:4117 in dwg_encode_LWPOLYLINE\n```","files":null},{"type":3,"author":{"id":"62f2fa164ca23ed14e237c3c802be09d069144f8"},"timestamp":1577772832,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDU2OTg3MTY4Ng==","github-url":"https://github.com/LibreDWG/libredwg/issues/178#issuecomment-569871686"},"message":"**file:null_pointer2**\n**5. There is a NULL pointer dereference in the function /src/common_entity_handle_data.spec:37**\nASAN report:\n```\n==97720==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x7f91db437390 bp 0x7ffed659dc00 sp 0x7ffed659d7c0 T0)\n==97720==The signal is caused by a READ memory access.\n==97720==Hint: address points to the zero page.\n    #0 0x7f91db43738f in dwg_encode_common_entity_handle_data /home/sv/Documents/libredwg-master/src/common_entity_handle_data.spec:37\n    #1 0x7f91db3a4957 in dwg_encode_LWPOLYLINE /home/sv/Documents/libredwg-master/src/dwg.spec:4132\n    #2 0x7f91db42fd87 in dwg_encode_add_object /home/sv/Documents/libredwg-master/src/encode.c:1897\n    #3 0x7f91db2ac341 in dwg_encode /home/sv/Documents/libredwg-master/src/encode.c:1191\n    #4 0x7f91da6582ec in dwg_write_file /home/sv/Documents/libredwg-master/src/dwg.c:350\n    #5 0x5632dd18b44e in main /home/sv/Documents/libredwg-master/programs/dwgrewrite.c:286\n    #6 0x7f91d9d6bb96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)\n    #7 0x5632dd18a149 in _start (/home/sv/output3/bin/dwgrewrite+0x2149)\n\nAddressSanitizer can not provide additional info.\nSUMMARY: AddressSanitizer: SEGV /home/sv/Documents/libredwg-master/src/common_entity_handle_data.spec:37 in dwg_encode_common_entity_handle_data\n```","files":null},{"type":3,"author":{"id":"62f2fa164ca23ed14e237c3c802be09d069144f8"},"timestamp":1577772998,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDU2OTg3MTkxMg==","github-url":"https://github.com/LibreDWG/libredwg/issues/178#issuecomment-569871912"},"message":"**file:dos**\n**6. Crafted input will lead to denial of service in /src/bits.c:2069, for loop.**\nStack overview:\n```\npwndbg\u003e bt\n#0  bit_calc_CRC (len=913972745, addr=0x7fff76407000 \"\", seed=\u003coptimized out\u003e) at bits.c:2071\n#1  bit_write_CRC (dat=dat@entry=0x7fffffffd300, start_address=start_address@entry=1692740325, seed=seed@entry=49345) at bits.c:1312\n#2  0x00007ffff7b15fb5 in dwg_encode_add_object (obj=0x5555557cfd20, dat=0x7fffffffd300, address=1692740325) at encode.c:2049\n#3  0x00007ffff7b1e6f6 in dwg_encode (dwg=0x7fffffffd4c0, dat=dat@entry=0x7fffffffd300) at encode.c:1191\n#4  0x00007ffff77e8034 in dwg_write_file (filename=0x5555557582c0 \"findings:id:000153,sig:11,src:000000,op:flip1,pos:398050-rewrite.dwg\", dwg=\u003coptimized out\u003e) at dwg.c:350\n#5  0x00005555555551e7 in main (argc=argc@entry=2, argv=argv@entry=0x7fffffffe558) at dwgrewrite.c:286\n#6  0x00007ffff6fb5b97 in __libc_start_main (main=0x555555554e20 \u003cmain\u003e, argc=2, argv=0x7fffffffe558, init=\u003coptimized out\u003e, fini=\u003coptimized out\u003e, rtld_fini=\u003coptimized out\u003e, stack_end=0x7fffffffe548) at ../csu/libc-start.c:310\n#7  0x000055555555548a in _start ()\n```","files":null},{"type":6,"author":{"id":"62f2fa164ca23ed14e237c3c802be09d069144f8"},"timestamp":1577772998,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdDMzMTE4NzkzNA=="},"target":"a73a64a3dfd06924841f43c784778c7f6c4f8c568534fef364a43ee5787286d5","message":"**file:dos**\n**6. Crafted input will lead to denial of service in /src/bits.c:2069, for-loop statement.**\nStack overview:\n```\npwndbg\u003e bt\n#0  bit_calc_CRC (len=913972745, addr=0x7fff76407000 \"\", seed=\u003coptimized out\u003e) at bits.c:2071\n#1  bit_write_CRC (dat=dat@entry=0x7fffffffd300, start_address=start_address@entry=1692740325, seed=seed@entry=49345) at bits.c:1312\n#2  0x00007ffff7b15fb5 in dwg_encode_add_object (obj=0x5555557cfd20, dat=0x7fffffffd300, address=1692740325) at encode.c:2049\n#3  0x00007ffff7b1e6f6 in dwg_encode (dwg=0x7fffffffd4c0, dat=dat@entry=0x7fffffffd300) at encode.c:1191\n#4  0x00007ffff77e8034 in dwg_write_file (filename=0x5555557582c0 \"findings:id:000153,sig:11,src:000000,op:flip1,pos:398050-rewrite.dwg\", dwg=\u003coptimized out\u003e) at dwg.c:350\n#5  0x00005555555551e7 in main (argc=argc@entry=2, argv=argv@entry=0x7fffffffe558) at dwgrewrite.c:286\n#6  0x00007ffff6fb5b97 in __libc_start_main (main=0x555555554e20 \u003cmain\u003e, argc=2, argv=0x7fffffffe558, init=\u003coptimized out\u003e, fini=\u003coptimized out\u003e, rtld_fini=\u003coptimized out\u003e, stack_end=0x7fffffffe548) at ../csu/libc-start.c:310\n#7  0x000055555555548a in _start ()\n```","files":null},{"type":5,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1577773042,"metadata":{"github-id":"MDEyOkxhYmVsZWRFdmVudDI5MTUxNTcyNTU="},"added":["bug"],"removed":[]},{"type":3,"author":{"id":"62f2fa164ca23ed14e237c3c802be09d069144f8"},"timestamp":1577773186,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDU2OTg3MjI1MA==","github-url":"https://github.com/LibreDWG/libredwg/issues/178#issuecomment-569872250"},"message":"**file:memory_leak**\n**6. Crafted input will lead to stack overflow in 0.9.3 or memory leak in master branch in /src/bits.c:1355.**\nASAN report:\n```\n==97764==ERROR: LeakSanitizer: detected memory leaks\n\nDirect leak of 25 byte(s) in 1 object(s) allocated from:\n    #0 0x7f8aba412b50 in __interceptor_malloc (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xdeb50)\n    #1 0x7f8ab8ffd38a in bit_read_TF /home/sv/Documents/libredwg-master/src/bits.c:1355\n    #2 0x7f8ab908a0e6 in dwg_decode_eed /home/sv/Documents/libredwg-master/src/decode.c:3232\n    #3 0x7f8ab908cebf in dwg_decode_entity /home/sv/Documents/libredwg-master/src/decode.c:3550\n    #4 0x7f8ab937ad6f in dwg_decode_LWPOLYLINE_private /home/sv/Documents/libredwg-master/src/dwg.spec:4048\n    #5 0x7f8ab937aa13 in dwg_decode_LWPOLYLINE /home/sv/Documents/libredwg-master/src/dwg.spec:4048\n    #6 0x7f8ab949d2fa in dwg_decode_add_object /home/sv/Documents/libredwg-master/src/decode.c:4945\n    #7 0x7f8ab905fc5d in decode_R13_R2000 /home/sv/Documents/libredwg-master/src/decode.c:1240\n    #8 0x7f8ab9001b7e in dwg_decode /home/sv/Documents/libredwg-master/src/decode.c:239\n    #9 0x7f8ab8fe9a65 in dwg_read_file /home/sv/Documents/libredwg-master/src/dwg.c:206\n    #10 0x5588b8500531 in main /home/sv/Documents/libredwg-master/programs/dwgrewrite.c:303\n    #11 0x7f8ab86feb96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)\n\nSUMMARY: AddressSanitizer: 25 byte(s) leaked in 1 allocation(s).\n```","files":null},{"type":6,"author":{"id":"62f2fa164ca23ed14e237c3c802be09d069144f8"},"timestamp":1577773186,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdDMzMTE4ODQxMw=="},"target":"1128d9d2f54a9d0c8974f774b01f33e2ee9fe9d91daa42c786a003d3a93c5d21","message":"**file:memory_leak**\n**7. Crafted input will lead to stack overflow in 0.9.3 or memory leak in master branch in /src/bits.c:1355.**\nASAN report:\n```\n==97764==ERROR: LeakSanitizer: detected memory leaks\n\nDirect leak of 25 byte(s) in 1 object(s) allocated from:\n    #0 0x7f8aba412b50 in __interceptor_malloc (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xdeb50)\n    #1 0x7f8ab8ffd38a in bit_read_TF /home/sv/Documents/libredwg-master/src/bits.c:1355\n    #2 0x7f8ab908a0e6 in dwg_decode_eed /home/sv/Documents/libredwg-master/src/decode.c:3232\n    #3 0x7f8ab908cebf in dwg_decode_entity /home/sv/Documents/libredwg-master/src/decode.c:3550\n    #4 0x7f8ab937ad6f in dwg_decode_LWPOLYLINE_private /home/sv/Documents/libredwg-master/src/dwg.spec:4048\n    #5 0x7f8ab937aa13 in dwg_decode_LWPOLYLINE /home/sv/Documents/libredwg-master/src/dwg.spec:4048\n    #6 0x7f8ab949d2fa in dwg_decode_add_object /home/sv/Documents/libredwg-master/src/decode.c:4945\n    #7 0x7f8ab905fc5d in decode_R13_R2000 /home/sv/Documents/libredwg-master/src/decode.c:1240\n    #8 0x7f8ab9001b7e in dwg_decode /home/sv/Documents/libredwg-master/src/decode.c:239\n    #9 0x7f8ab8fe9a65 in dwg_read_file /home/sv/Documents/libredwg-master/src/dwg.c:206\n    #10 0x5588b8500531 in main /home/sv/Documents/libredwg-master/programs/dwgrewrite.c:303\n    #11 0x7f8ab86feb96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)\n\nSUMMARY: AddressSanitizer: 25 byte(s) leaked in 1 allocation(s).\n```","files":null},{"type":3,"author":{"id":"62f2fa164ca23ed14e237c3c802be09d069144f8"},"timestamp":1577773169,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDU2OTg3MjMwMQ==","github-url":"https://github.com/LibreDWG/libredwg/issues/178#issuecomment-569872301"},"message":"[poc.zip](https://github.com/LibreDWG/libredwg/files/4012028/poc.zip)\npocs are here.","files":null},{"type":3,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1577773171,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDU2OTg3MjMwNg==","github-url":"https://github.com/LibreDWG/libredwg/issues/178#issuecomment-569872306"},"message":"I haven't fuzzed `dwgrewrite` yet, thanks. Just started fuzzing dxf2dwg only.","files":null},{"type":3,"author":{"id":"62f2fa164ca23ed14e237c3c802be09d069144f8"},"timestamp":1577773486,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDU2OTg3MjgyMw==","github-url":"https://github.com/LibreDWG/libredwg/issues/178#issuecomment-569872823"},"message":"\u003e I haven't fuzzed `dwgrewrite` yet, thanks. Just started fuzzing dxf2dwg only.\n\nNo worries, many people are fuzzing ```libredwg``` as far as i know.","files":null},{"type":3,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1577805049,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDU2OTk0MzE0OA==","github-url":"https://github.com/LibreDWG/libredwg/issues/178#issuecomment-569943148"},"message":"I'm having about 170 crashes in my pipeline, which seem to be ~4 missing new protections","files":null},{"type":3,"author":{"id":"62f2fa164ca23ed14e237c3c802be09d069144f8"},"timestamp":1577806708,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDU2OTk0NzEyOQ==","github-url":"https://github.com/LibreDWG/libredwg/issues/178#issuecomment-569947129"},"message":"\u003e I'm having about 170 crashes in my pipeline, which seem to be ~4 missing new protections\n\nYeah, I got ~700 crashes before, but I think these 7 bugs are useful. And GOOD job, these bugs seem to be done.","files":null},{"type":3,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1577893670,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDU3MDA2Mjc4MA==","github-url":"https://github.com/LibreDWG/libredwg/issues/178#issuecomment-570062780"},"message":"head_overflow2 is the most interesting and only remaining one.\nThe TABLE 0.2.9BC is not detected as entity in decode.","files":null},{"type":6,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1577893670,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdDMzMTUwMzkyMg=="},"target":"8a49ff6d1a80dbd042725d955b59a8eafd427e4fb82d1b2e40fe88450eaa9e64","message":"head_overflow2 is the most interesting and only remaining one.\nThe TABLECONTENT 0.2.9BC is wrongly decoded as TABLE entity, mixed up \n```\nClass 528 0x401 ACAD_TABLE\n AcDbTable \"ObjectDBX Classes\" 0 0x1f2\nClass 529 0x480 TABLE\n AcDbTableContent \"ObjectDBX Classes\" 0 0x0\n```","files":null},{"type":6,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1577893779,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdDMzMTUwNDA5Ng=="},"target":"8a49ff6d1a80dbd042725d955b59a8eafd427e4fb82d1b2e40fe88450eaa9e64","message":"head_overflow2 is the most interesting and only remaining one.\nThe TABLECONTENT 0.2.9BC is wrongly decoded as TABLE entity, mixed up \n```\nClass 528 0x401 ACAD_TABLE\n AcDbTable \"ObjectDBX Classes\" 0 0x1f2\nClass 529 0x480 TABLE\n AcDbTableContent \"ObjectDBX Classes\" 0 0x0\n\nObject number: 468, Size: 8316 [MS], Type: 529 [BS]\nWarning: Unhandled Class entity 528 ACAD_TABLE (0x401) 468/9BC\nEncode entity UNKNOWN_ENT\n```","files":null},{"type":6,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1577893841,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdDMzMTUwNDE5Mw=="},"target":"8a49ff6d1a80dbd042725d955b59a8eafd427e4fb82d1b2e40fe88450eaa9e64","message":"head_overflow2 is the most interesting and only remaining one.\nThe TABLECONTENT 0.2.9BC is wrongly decoded as TABLE entity, mixed up \n```\nClass 528 0x401 ACAD_TABLE\n AcDbTable \"ObjectDBX Classes\" 0 0x1f2\nClass 529 0x480 TABLE\n AcDbTableContent \"ObjectDBX Classes\" 0 0x0\n\n\u003c Warning: Unknown Class object 529 TABLE (0x480)\nAdd object UNKNOWN_OBJ Decode object UNKNOWN_OBJ\n\n\u003e Object number: 468, Size: 8316 [MS], Type: 529 [BS]\nWarning: Unhandled Class entity 528 ACAD_TABLE (0x401) 468/9BC\nEncode entity UNKNOWN_ENT\n```","files":null},{"type":6,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1577893874,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdDMzMTUwNDI1Mw=="},"target":"8a49ff6d1a80dbd042725d955b59a8eafd427e4fb82d1b2e40fe88450eaa9e64","message":"head_overflow2 is the most interesting and only remaining one.\nThe TABLECONTENT 0.2.9BC is wrongly encoded as TABLE entity, mixed up \n```\nClass 528 0x401 ACAD_TABLE\n AcDbTable \"ObjectDBX Classes\" 0 0x1f2\nClass 529 0x480 TABLE\n AcDbTableContent \"ObjectDBX Classes\" 0 0x0\n\n\u003c Warning: Unknown Class object 529 TABLE (0x480)\nAdd object UNKNOWN_OBJ Decode object UNKNOWN_OBJ\n\n\u003e Object number: 468, Size: 8316 [MS], Type: 529 [BS]\nWarning: Unhandled Class entity 528 ACAD_TABLE (0x401) 468/9BC\nEncode entity UNKNOWN_ENT\n```","files":null},{"type":6,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1577893927,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdDMzMTUwNDM1OQ=="},"target":"8a49ff6d1a80dbd042725d955b59a8eafd427e4fb82d1b2e40fe88450eaa9e64","message":"head_overflow2 is the most interesting and only remaining one.\nThe TABLECONTENT 0.2.9BC is wrongly encoded as TABLE entity, mixed up \n```\nClass 528 0x401 ACAD_TABLE\n AcDbTable \"ObjectDBX Classes\" 0 0x1f2\nClass 529 0x480 TABLE\n AcDbTableContent \"ObjectDBX Classes\" 0 0x0\n\n\u003c Object number: 468/1D4, Size: 8316 [MS], Type: 529 [BS]\nWarning: Unknown Class object 529 TABLE (0x480)\nAdd object UNKNOWN_OBJ Decode object UNKNOWN_OBJ\n\n\u003e Object number: 468, Size: 8316 [MS], Type: 529 [BS]\nWarning: Unhandled Class entity 528 ACAD_TABLE (0x401) 468/9BC\nEncode entity UNKNOWN_ENT\n```","files":null},{"type":6,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1577898561,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdDMzMTUxMzQ1OQ=="},"target":"8a49ff6d1a80dbd042725d955b59a8eafd427e4fb82d1b2e40fe88450eaa9e64","message":"head_overflow2 is the most interesting and only remaining one.\nThe TABLECONTENT 0.2.9BC is wrongly encoded as TABLE entity, mixed up. (but only here in a fuzzed DXF, not in reality)\n```\nClass 528 0x401 ACAD_TABLE\n AcDbTable \"ObjectDBX Classes\" 0 0x1f2\nClass 529 0x480 TABLE\n AcDbTableContent \"ObjectDBX Classes\" 0 0x0\n\n\u003c Object number: 468/1D4, Size: 8316 [MS], Type: 529 [BS]\nWarning: Unknown Class object 529 TABLE (0x480)\nAdd object UNKNOWN_OBJ Decode object UNKNOWN_OBJ\n\n\u003e Object number: 468, Size: 8316 [MS], Type: 529 [BS]\nWarning: Unhandled Class entity 528 ACAD_TABLE (0x401) 468/9BC\nEncode entity UNKNOWN_ENT\n```","files":null},{"type":3,"author":{"id":"62f2fa164ca23ed14e237c3c802be09d069144f8"},"timestamp":1577940589,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDU3MDExNzc1Mg==","github-url":"https://github.com/LibreDWG/libredwg/issues/178#issuecomment-570117752"},"message":"\u003e head_overflow2 is the most interesting and only remaining one.\n\u003e The TABLECONTENT 0.2.9BC is wrongly encoded as TABLE entity, mixed up. (but only here in a fuzzed DXF, not in reality)\n\u003e \n\u003e ```\n\u003e Class 528 0x401 ACAD_TABLE\n\u003e  AcDbTable \"ObjectDBX Classes\" 0 0x1f2\n\u003e Class 529 0x480 TABLE\n\u003e  AcDbTableContent \"ObjectDBX Classes\" 0 0x0\n\u003e \n\u003e \u003c Object number: 468/1D4, Size: 8316 [MS], Type: 529 [BS]\n\u003e Warning: Unknown Class object 529 TABLE (0x480)\n\u003e Add object UNKNOWN_OBJ Decode object UNKNOWN_OBJ\n\u003e \n\u003e \u003e Object number: 468, Size: 8316 [MS], Type: 529 [BS]\n\u003e Warning: Unhandled Class entity 528 ACAD_TABLE (0x401) 468/9BC\n\u003e Encode entity UNKNOWN_ENT\n\u003e ```\n\nExactly! This issue made me confused. So weired the structure is:\n```\n  number = 506, \n  proxyflag = 1153, \n  appname = 0x6030000009d0 \"ObjectDBX Classes\", \n  cppname = 0x6020000001f0 \"AcDbMaterial\", \n  dxfname = 0x602000000210 \"MATERIAL\", \n  dxfname_u = 0x0, \n  wasazombie = 0 '\\000', \n  item_class_id = 499, \n  num_instances = 0, \n  dwg_version = 0, \n  maint_version = 0, \n  unknown_1 = 0, \n  unknown_2 = 0\n```","files":null},{"type":3,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1577982268,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDU3MDI1OTEyMQ==","github-url":"https://github.com/LibreDWG/libredwg/issues/178#issuecomment-570259121"},"message":"All fixed in master since 3f503dd294efc63a59608d8a16058c41d44ba13a","files":null},{"type":4,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1577982268,"metadata":{"github-id":"MDExOkNsb3NlZEV2ZW50MjkxODE0ODAzNA=="},"status":2},{"type":3,"author":{"id":"62f2fa164ca23ed14e237c3c802be09d069144f8"},"timestamp":1577982565,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDU3MDI2MDYxMA==","github-url":"https://github.com/LibreDWG/libredwg/issues/178#issuecomment-570260610"},"message":"\u003e All fixed in master since [3f503dd](https://github.com/LibreDWG/libredwg/commit/3f503dd294efc63a59608d8a16058c41d44ba13a)\n\nWell down! Are you requesting CVEs for me?","files":null},{"type":3,"author":{"id":"62f2fa164ca23ed14e237c3c802be09d069144f8"},"timestamp":1577987630,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDU3MDI4NjU5MQ==","github-url":"https://github.com/LibreDWG/libredwg/issues/178#issuecomment-570286591"},"message":"These bugs are credited by Skyvast in ADLab of Venustech.","files":null},{"type":3,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1577990186,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDU3MDI5OTc4OQ==","github-url":"https://github.com/LibreDWG/libredwg/issues/178#issuecomment-570299789"},"message":"No CVE's by me. Too busy preparing the next release.","files":null},{"type":5,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1579176723,"metadata":{"github-id":"MDEyOkxhYmVsZWRFdmVudDI5NTQzMDE2MjA="},"added":["fuzzing"],"removed":[]}]}