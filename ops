{"version":1,"ops":[{"type":3,"author":{"id":"62f2fa164ca23ed14e237c3c802be09d069144f8"},"timestamp":1579175548,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDU3NTExNzQyMg==","github-url":"https://github.com/LibreDWG/libredwg/issues/190#issuecomment-575117422"},"message":"heap over flow1\n=================================================================\n==9430==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x6020000515c8 at pc 0x7f0679221526 bp 0x7fff931e9240 sp 0x7fff931e9230\nREAD of size 8 at 0x6020000515c8 thread T0\n    #0 0x7f0679221525 in add_MLINE /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:4637\n    #1 0x7f06792532d4 in new_object /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:5930\n    #2 0x7f067925fcbd in dxf_blocks_read /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:6955\n    #3 0x7f067926989a in dwg_read_dxf /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:7679\n    #4 0x7f0678382ee7 in dxf_read_file /home/skyvast/Documents/libredwg-0.10.1.2677/src/dwg.c:319\n    #5 0x55ef2f125465 in main /home/skyvast/Documents/libredwg-0.10.1.2677/programs/dxf2dwg.c:255\n    #6 0x7f0677a8db96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)\n    #7 0x55ef2f124489 in _start (/home/skyvast/Documents/asan_libredwg/bin/dxf2dwg+0x2489)\n\n0x6020000515c8 is located 8 bytes to the left of 16-byte region [0x6020000515d0,0x6020000515e0)\nfreed by thread T0 here:\n    #0 0x7f06798117b8 in __interceptor_free (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xde7b8)\n    #1 0x7f06791e3788 in dxf_free_pair /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:285\n    #2 0x7f067925ccd6 in new_object /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:6699\n    #3 0x7f067925fcbd in dxf_blocks_read /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:6955\n    #4 0x7f067926989a in dwg_read_dxf /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:7679\n    #5 0x7f0678382ee7 in dxf_read_file /home/skyvast/Documents/libredwg-0.10.1.2677/src/dwg.c:319\n    #6 0x55ef2f125465 in main /home/skyvast/Documents/libredwg-0.10.1.2677/programs/dxf2dwg.c:255\n    #7 0x7f0677a8db96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)\n\npreviously allocated by thread T0 here:\n    #0 0x7f0679811d38 in __interceptor_calloc (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xded38)\n    #1 0x7f06791e1465 in xcalloc /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:76\n    #2 0x7f06791e37b0 in dxf_read_pair /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:292\n    #3 0x7f067925cce5 in new_object /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:6700\n    #4 0x7f067925fcbd in dxf_blocks_read /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:6955\n    #5 0x7f067926989a in dwg_read_dxf /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:7679\n    #6 0x7f0678382ee7 in dxf_read_file /home/skyvast/Documents/libredwg-0.10.1.2677/src/dwg.c:319\n    #7 0x55ef2f125465 in main /home/skyvast/Documents/libredwg-0.10.1.2677/programs/dxf2dwg.c:255\n    #8 0x7f0677a8db96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:4637 in add_MLINE\nShadow bytes around the buggy address:\n  0x0c0480002260: fa fa fd fd fa fa fd fd fa fa fd fd fa fa fd fd\n  0x0c0480002270: fa fa fd fd fa fa fd fd fa fa fd fd fa fa fd fd\n  0x0c0480002280: fa fa fd fd fa fa fd fd fa fa fd fd fa fa fd fd\n  0x0c0480002290: fa fa fd fd fa fa fd fd fa fa fd fd fa fa fd fd\n  0x0c04800022a0: fa fa fd fd fa fa fd fd fa fa fd fd fa fa 01 fa\n=\u003e0x0c04800022b0: fa fa fd fd fa fa fd fd fa[fa]fd fd fa fa fd fd\n  0x0c04800022c0: fa fa 00 00 fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c04800022d0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c04800022e0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c04800022f0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c0480002300: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07 \n  Heap left redzone:       fa\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n==9430==ABORTING","files":null},{"type":6,"author":{"id":"62f2fa164ca23ed14e237c3c802be09d069144f8"},"timestamp":1579175548,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdDMzODgzOTYwNQ=="},"target":"84f5b7370b4ebd4eb59350a81ad78b07915481014b8376c2c7e55de3ffc8dacb","message":"Heap over flow1\n=================================================================\n==9430==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x6020000515c8 at pc 0x7f0679221526 bp 0x7fff931e9240 sp 0x7fff931e9230\nREAD of size 8 at 0x6020000515c8 thread T0\n    #0 0x7f0679221525 in add_MLINE /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:4637\n    #1 0x7f06792532d4 in new_object /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:5930\n    #2 0x7f067925fcbd in dxf_blocks_read /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:6955\n    #3 0x7f067926989a in dwg_read_dxf /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:7679\n    #4 0x7f0678382ee7 in dxf_read_file /home/skyvast/Documents/libredwg-0.10.1.2677/src/dwg.c:319\n    #5 0x55ef2f125465 in main /home/skyvast/Documents/libredwg-0.10.1.2677/programs/dxf2dwg.c:255\n    #6 0x7f0677a8db96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)\n    #7 0x55ef2f124489 in _start (/home/skyvast/Documents/asan_libredwg/bin/dxf2dwg+0x2489)\n\n0x6020000515c8 is located 8 bytes to the left of 16-byte region [0x6020000515d0,0x6020000515e0)\nfreed by thread T0 here:\n    #0 0x7f06798117b8 in __interceptor_free (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xde7b8)\n    #1 0x7f06791e3788 in dxf_free_pair /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:285\n    #2 0x7f067925ccd6 in new_object /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:6699\n    #3 0x7f067925fcbd in dxf_blocks_read /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:6955\n    #4 0x7f067926989a in dwg_read_dxf /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:7679\n    #5 0x7f0678382ee7 in dxf_read_file /home/skyvast/Documents/libredwg-0.10.1.2677/src/dwg.c:319\n    #6 0x55ef2f125465 in main /home/skyvast/Documents/libredwg-0.10.1.2677/programs/dxf2dwg.c:255\n    #7 0x7f0677a8db96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)\n\npreviously allocated by thread T0 here:\n    #0 0x7f0679811d38 in __interceptor_calloc (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xded38)\n    #1 0x7f06791e1465 in xcalloc /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:76\n    #2 0x7f06791e37b0 in dxf_read_pair /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:292\n    #3 0x7f067925cce5 in new_object /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:6700\n    #4 0x7f067925fcbd in dxf_blocks_read /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:6955\n    #5 0x7f067926989a in dwg_read_dxf /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:7679\n    #6 0x7f0678382ee7 in dxf_read_file /home/skyvast/Documents/libredwg-0.10.1.2677/src/dwg.c:319\n    #7 0x55ef2f125465 in main /home/skyvast/Documents/libredwg-0.10.1.2677/programs/dxf2dwg.c:255\n    #8 0x7f0677a8db96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:4637 in add_MLINE\nShadow bytes around the buggy address:\n  0x0c0480002260: fa fa fd fd fa fa fd fd fa fa fd fd fa fa fd fd\n  0x0c0480002270: fa fa fd fd fa fa fd fd fa fa fd fd fa fa fd fd\n  0x0c0480002280: fa fa fd fd fa fa fd fd fa fa fd fd fa fa fd fd\n  0x0c0480002290: fa fa fd fd fa fa fd fd fa fa fd fd fa fa fd fd\n  0x0c04800022a0: fa fa fd fd fa fa fd fd fa fa fd fd fa fa 01 fa\n=\u003e0x0c04800022b0: fa fa fd fd fa fa fd fd fa[fa]fd fd fa fa fd fd\n  0x0c04800022c0: fa fa 00 00 fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c04800022d0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c04800022e0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c04800022f0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c0480002300: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07 \n  Heap left redzone:       fa\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n==9430==ABORTING","files":null},{"type":3,"author":{"id":"62f2fa164ca23ed14e237c3c802be09d069144f8"},"timestamp":1579175562,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDU3NTExNzU3NQ==","github-url":"https://github.com/LibreDWG/libredwg/issues/190#issuecomment-575117575"},"message":"Heap_overflow2\n================================================================\n==9471==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x6020000204a8 at pc 0x7f66ed6bc79e bp 0x7fff91c13050 sp 0x7fff91c13040\nREAD of size 8 at 0x6020000204a8 thread T0\n    #0 0x7f66ed6bc79d in add_MLINE /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:4645\n    #1 0x7f66ed6ee2d4 in new_object /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:5930\n    #2 0x7f66ed6facbd in dxf_blocks_read /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:6955\n    #3 0x7f66ed70489a in dwg_read_dxf /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:7679\n    #4 0x7f66ec81dee7 in dxf_read_file /home/skyvast/Documents/libredwg-0.10.1.2677/src/dwg.c:319\n    #5 0x55a8060bf465 in main /home/skyvast/Documents/libredwg-0.10.1.2677/programs/dxf2dwg.c:255\n    #6 0x7f66ebf28b96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)\n    #7 0x55a8060be489 in _start (/home/skyvast/Documents/asan_libredwg/bin/dxf2dwg+0x2489)\n\n0x6020000204a8 is located 8 bytes to the left of 16-byte region [0x6020000204b0,0x6020000204c0)\nallocated by thread T0 here:\n    #0 0x7f66edcacd38 in __interceptor_calloc (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xded38)\n    #1 0x7f66ed67c465 in xcalloc /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:76\n    #2 0x7f66ed67e7b0 in dxf_read_pair /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:292\n    #3 0x7f66ed6f7ce5 in new_object /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:6700\n    #4 0x7f66ed6facbd in dxf_blocks_read /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:6955\n    #5 0x7f66ed70489a in dwg_read_dxf /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:7679\n    #6 0x7f66ec81dee7 in dxf_read_file /home/skyvast/Documents/libredwg-0.10.1.2677/src/dwg.c:319\n    #7 0x55a8060bf465 in main /home/skyvast/Documents/libredwg-0.10.1.2677/programs/dxf2dwg.c:255\n    #8 0x7f66ebf28b96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow /home/skyvast/Documents/libredwg-0.10.1.2677/src/in_dxf.c:4645 in add_MLINE\nShadow bytes around the buggy address:\n  0x0c047fffc040: fa fa fd fd fa fa fd fd fa fa fd fd fa fa fd fd\n  0x0c047fffc050: fa fa fd fd fa fa fd fd fa fa fd fd fa fa fd fd\n  0x0c047fffc060: fa fa fd fd fa fa fd fd fa fa fd fd fa fa fd fd\n  0x0c047fffc070: fa fa fd fd fa fa fd fd fa fa fd fd fa fa fd fd\n  0x0c047fffc080: fa fa fd fd fa fa fd fd fa fa 01 fa fa fa fd fd\n=\u003e0x0c047fffc090: fa fa fd fd fa[fa]00 00 fa fa fa fa fa fa fa fa\n  0x0c047fffc0a0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c047fffc0b0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c047fffc0c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c047fffc0d0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c047fffc0e0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07 \n  Heap left redzone:       fa\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n==9471==ABORTING","files":null},{"type":3,"author":{"id":"62f2fa164ca23ed14e237c3c802be09d069144f8"},"timestamp":1579175579,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDU3NTExNzY1OA==","github-url":"https://github.com/LibreDWG/libredwg/issues/190#issuecomment-575117658"},"message":"PoC here.\n[heap_overflow.zip](https://github.com/LibreDWG/libredwg/files/4071008/heap_overflow.zip)","files":null},{"type":5,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1579176493,"metadata":{"github-id":"MDEyOkxhYmVsZWRFdmVudDI5NTQyOTA5MTM="},"added":["bug"],"removed":[]},{"type":3,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1579176513,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDU3NTEyMzI3OA==","github-url":"https://github.com/LibreDWG/libredwg/issues/190#issuecomment-575123278"},"message":"Thanks, I can repro all","files":null},{"type":5,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1579176666,"metadata":{"github-id":"MDEyOkxhYmVsZWRFdmVudDI5NTQyOTkwMzQ="},"added":["fuzzing"],"removed":[]},{"type":4,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1579216877,"metadata":{"github-id":"MDExOkNsb3NlZEV2ZW50Mjk1NjQwOTAxMA=="},"status":2}]}