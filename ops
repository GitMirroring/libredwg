{"version":1,"ops":[{"type":3,"author":{"id":"1b887fa524848596ba06633285df999b53626bc3"},"timestamp":1564270855,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUxNTcyMDk2OA==","github-url":"https://github.com/LibreDWG/libredwg/issues/126#issuecomment-515720968"},"message":"#### 2. Invalid free in dwg.c:197\nPoC: https://github.com/strongcourage/PoCs/blob/master/libredwg_959984b/PoC_af_dwg.c:197\nASAN says:\n~~~\n==17272==ERROR: AddressSanitizer: attempting free on address which was not malloc()-ed: 0x7f2eaf776035 in thread T0\n    #0 0x7f2eae72432a in __interceptor_free (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x9832a)\n    #1 0x4047b0 in dwg_read_file ../../src/dwg.c:197\n    #2 0x403767 in main ../../programs/dwg2SVG.c:376\n    #3 0x7f2eadfd982f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n    #4 0x401948 in _start (/home/dungnguyen/PoCs/libredwg_959984b/dwg2SVG-asan+0x401948)\n~~~","files":null},{"type":3,"author":{"id":"1b887fa524848596ba06633285df999b53626bc3"},"timestamp":1564270932,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUxNTcyMTAyNg==","github-url":"https://github.com/LibreDWG/libredwg/issues/126#issuecomment-515721026"},"message":"#### 3. Heap buffer overflow in bits.c:1818\nPoC: https://github.com/strongcourage/PoCs/blob/master/libredwg_959984b/PoC_hbo_bits.c:1818\nASAN says:\n~~~\n==15391==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x7f0f6b847455 at pc 0x0000004132e1 bp 0x7ffe4fb14ab0 sp 0x7ffe4fb14aa0\nREAD of size 1 at 0x7f0f6b847455 thread T0\n    #0 0x4132e0 in bit_calc_CRC ../../src/bits.c:1818\n    #1 0x410820 in bit_check_CRC ../../src/bits.c:1213\n    #2 0x83b985 in dwg_decode_add_object ../../src/decode.c:4430\n    #3 0x489a76 in decode_R13_R2000 ../../src/decode.c:1092\n    #4 0x4141ec in dwg_decode ../../src/decode.c:220\n    #5 0x4046b8 in dwg_read_file ../../src/dwg.c:193\n    #6 0x403767 in main ../../programs/dwg2SVG.c:376\n    #7 0x7f0f6a07a82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n    #8 0x401948 in _start (/home/dungnguyen/PoCs/libredwg_959984b/dwg2SVG-asan+0x401948)\n~~~","files":null},{"type":3,"author":{"id":"1b887fa524848596ba06633285df999b53626bc3"},"timestamp":1564271008,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUxNTcyMTA3Ng==","github-url":"https://github.com/LibreDWG/libredwg/issues/126#issuecomment-515721076"},"message":"#### 4. HBO in decode.c:1578\nPoC: https://github.com/strongcourage/PoCs/blob/master/libredwg_959984b/PoC_hbo_decode.c:1578\nASAN says:\n~~~\n==24710==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x62c000007600 at pc 0x00000048ffe9 bp 0x7ffd1c2630c0 sp 0x7ffd1c2630b0\nWRITE of size 1 at 0x62c000007600 thread T0\n    #0 0x48ffe8 in decompress_R2004_section ../../src/decode.c:1578\n    #1 0x493a4c in read_2004_compressed_section ../../src/decode.c:1966\n    #2 0x493e3a in read_2004_section_classes ../../src/decode.c:1999\n    #3 0x4a1f2f in decode_R2004 ../../src/decode.c:2423\n    #4 0x414342 in dwg_decode ../../src/decode.c:226\n    #5 0x4046b8 in dwg_read_file ../../src/dwg.c:193\n    #6 0x403767 in main ../../programs/dwg2SVG.c:376\n    #7 0x7fd8a7f7c82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n    #8 0x401948 in _start (/home/dungnguyen/PoCs/libredwg_959984b/dwg2SVG-asan+0x401948)\n~~~","files":null},{"type":3,"author":{"id":"1b887fa524848596ba06633285df999b53626bc3"},"timestamp":1564271069,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUxNTcyMTEyNA==","github-url":"https://github.com/LibreDWG/libredwg/issues/126#issuecomment-515721124"},"message":"#### 5. HBO in decode_r2007.c:222\nPoC: https://github.com/strongcourage/PoCs/blob/master/libredwg_959984b/PoC_hbo_decode_r2007.c:222\nASAN says: \n~~~\n==436==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x62300000de45 at pc 0x00000083d9f7 bp 0x7ffc10e72490 sp 0x7ffc10e72480\nREAD of size 1 at 0x62300000de45 thread T0\n    #0 0x83d9f6 in copy_bytes ../../src/decode_r2007.c:222\n    #1 0x843a2b in decompress_r2007 ../../src/decode_r2007.c:539\n    #2 0x844255 in read_system_page ../../src/decode_r2007.c:642\n    #3 0x845161 in read_sections_map ../../src/decode_r2007.c:810\n    #4 0x84e3bd in read_r2007_meta_data ../../src/decode_r2007.c:1673\n    #5 0x4a5e7d in decode_R2007 ../../src/decode.c:2463\n    #6 0x4142c6 in dwg_decode ../../src/decode.c:222\n    #7 0x4046b8 in dwg_read_file ../../src/dwg.c:193\n    #8 0x403767 in main ../../programs/dwg2SVG.c:376\n    #9 0x7f0484a6e82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n    #10 0x401948 in _start (/home/dungnguyen/PoCs/libredwg_959984b/dwg2SVG-asan+0x401948)\n~~~","files":null},{"type":3,"author":{"id":"1b887fa524848596ba06633285df999b53626bc3"},"timestamp":1564271135,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUxNTcyMTE3Nw==","github-url":"https://github.com/LibreDWG/libredwg/issues/126#issuecomment-515721177"},"message":"#### 6. SBO in dwg.c:1175\nPoC: https://github.com/strongcourage/PoCs/blob/master/libredwg_959984b/PoC_sbo_dwg.c:1175\nASAN says:\n~~~\n==17188==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7ffcf981e948 at pc 0x00000040aa27 bp 0x7ffcf981e8e0 sp 0x7ffcf981e8d0\nWRITE of size 1 at 0x7ffcf981e948 thread T0\n    #0 0x40aa26 in dwg_section_type ../../src/dwg.c:1175\n    #1 0x845b68 in read_sections_map ../../src/decode_r2007.c:882\n    #2 0x84e3bd in read_r2007_meta_data ../../src/decode_r2007.c:1673\n    #3 0x4a5e7d in decode_R2007 ../../src/decode.c:2463\n    #4 0x4142c6 in dwg_decode ../../src/decode.c:222\n    #5 0x4046b8 in dwg_read_file ../../src/dwg.c:193\n    #6 0x403767 in main ../../programs/dwg2SVG.c:376\n    #7 0x7fa18389382f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n    #8 0x401948 in _start (/home/dungnguyen/PoCs/libredwg_959984b/dwg2SVG-asan+0x401948)\n~~~","files":null},{"type":3,"author":{"id":"1b887fa524848596ba06633285df999b53626bc3"},"timestamp":1564271253,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUxNTcyMTI3Mg==","github-url":"https://github.com/LibreDWG/libredwg/issues/126#issuecomment-515721272"},"message":"#### 7. SEGV in bits.c:121\nPoC: https://github.com/strongcourage/PoCs/blob/master/libredwg_959984b/PoC_segv_bits.c:121\nASAN says:\n~~~\n==8815==ERROR: AddressSanitizer: SEGV on unknown address 0x7fa363c1c218 (pc 0x00000040bba4 bp 0x7fff9c760910 sp 0x7fff9c7608f0 T0)\n    #0 0x40bba3 in bit_read_B ../../src/bits.c:121\n    #1 0x849244 in obj_string_stream ../../src/decode_r2007.c:1224\n    #2 0x4aa0a5 in dwg_decode_entity ../../src/decode.c:2929\n    #3 0x5a5dc6 in dwg_decode_DIMENSION_DIAMETER_private ../../src/dwg.spec:1231\n    #4 0x5a5a37 in dwg_decode_DIMENSION_DIAMETER ../../src/dwg.spec:1231\n    #5 0x8387f5 in dwg_decode_add_object ../../src/decode.c:4077\n    #6 0x4970de in read_2004_section_handles ../../src/decode.c:2250\n    #7 0x4a1f6d in decode_R2004 ../../src/decode.c:2425\n    #8 0x414342 in dwg_decode ../../src/decode.c:226\n    #9 0x4046b8 in dwg_read_file ../../src/dwg.c:193\n    #10 0x403767 in main ../../programs/dwg2SVG.c:376\n    #11 0x7fa3590e982f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n    #12 0x401948 in _start (/home/dungnguyen/PoCs/libredwg_959984b/dwg2SVG-asan+0x401948)\n~~~","files":null},{"type":3,"author":{"id":"1b887fa524848596ba06633285df999b53626bc3"},"timestamp":1564271310,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUxNTcyMTMxMQ==","github-url":"https://github.com/LibreDWG/libredwg/issues/126#issuecomment-515721311"},"message":"#### 8. SEGV in bits.c:294\nPoC: https://github.com/strongcourage/PoCs/blob/master/libredwg_959984b/PoC_segv_bits.c:294\nASAN says:\n~~~\n==13588==ERROR: AddressSanitizer: SEGV on unknown address 0x7fdf9752e24e (pc 0x00000040cb68 bp 0x7ffcd84aa390 sp 0x7ffcd84aa370 T0)\n    #0 0x40cb67 in bit_read_RC ../../src/bits.c:294\n    #1 0x41001e in bit_read_H ../../src/bits.c:1120\n    #2 0x4b334c in dwg_decode_handleref_with_code ../../src/decode.c:3217\n    #3 0x63637b in dwg_decode_BLOCK_CONTROL_private ../../src/dwg.spec:2309\n    #4 0x635b00 in dwg_decode_BLOCK_CONTROL ../../src/dwg.spec:2300\n    #5 0x838b99 in dwg_decode_add_object ../../src/decode.c:4144\n    #6 0x4970de in read_2004_section_handles ../../src/decode.c:2250\n    #7 0x4a1f6d in decode_R2004 ../../src/decode.c:2425\n    #8 0x414342 in dwg_decode ../../src/decode.c:226\n    #9 0x4046b8 in dwg_read_file ../../src/dwg.c:193\n    #10 0x403767 in main ../../programs/dwg2SVG.c:376\n    #11 0x7fdf9290482f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n    #12 0x401948 in _start (/home/dungnguyen/PoCs/libredwg_959984b/dwg2SVG-asan+0x401948)\n~~~","files":null},{"type":5,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1564295593,"metadata":{"github-id":"MDEyOkxhYmVsZWRFdmVudDI1MTQ1NjUwNDI="},"added":["bug"],"removed":[]},{"type":3,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1564295676,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUxNTczNzIxNg==","github-url":"https://github.com/LibreDWG/libredwg/issues/126#issuecomment-515737216"},"message":"Nice, thanks","files":null},{"type":6,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1564295676,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdDI1NTQ3NzYyOA=="},"target":"27080ea3ad2645e3d1ac0a5f4f877f9fc2d016f9cd984a5e14f1f2e794035f80","message":"Nice, thanks.\nafl-fuzz or libfuzzer? I really have to set this up also","files":null},{"type":3,"author":{"id":"1b887fa524848596ba06633285df999b53626bc3"},"timestamp":1564298717,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUxNTczOTY5NA==","github-url":"https://github.com/LibreDWG/libredwg/issues/126#issuecomment-515739694"},"message":"You can fuzz it using AFL. The setup is very simple as follows:\n~~~\ngit clone https://git.savannah.gnu.org/git/libredwg.git; cd libredwg\nautoreconf -i\nmkdir obj-afl; cd obj-afl\nCC=/path/to/afl/afl-gcc ../configure --disable-shared\ncd programs; mkdir in; \ncp ../../test/test-data/*.dwg in # should remove some big files \u003e 1 Mb\n# fuzz dwg2dxf\n/path/to/afl/afl-fuzz -m none -i in -o out_dwg2dxf ./dwg2dxf @@ -o /dev/null\n# fuzz dwg2SVG\n/path/to/afl/afl-fuzz -m none -i in -o out_dwg2SVG ./dwg2SVG @@ /dev/null\n~~~\nThe reported bugs were easily to be detected after 2 hours, but the triaging step using ASAN was a bit tedious. My suggestion is that you can perform fuzzing to detect some easy-to-catch bugs in your modified code to make `libredwg` more robust. I am also happy to do so. Thanks.","files":null},{"type":3,"author":{"id":"1b887fa524848596ba06633285df999b53626bc3"},"timestamp":1564328862,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUxNTc3MzM3MA==","github-url":"https://github.com/LibreDWG/libredwg/issues/126#issuecomment-515773370"},"message":"Thanks @rurban for the patches. I rebuilt the program `libredwg` (commit b0b41f5 on branch `smoke/gh126-fuzzing`) with ASAN using your command as mentioned in b0b41f5. \n~~~\nCFLAGS=\"-O2 -g -fsanitize=address -fno-omit-frame-pointer\" ./configure --disable-static --disable-bindings --disable-dxf --disable-write\n~~~\n\nThen, I run it with crashing inputs generated by fuzzing on the buggy commit  959984b on master. Some bugs have been fixed. However, if you don't mind, I report some bugs that have still existed after your fixes as follows.\n\nCommand: ./examples/dwg2svg2 $PoC\n\n#### 9. HBO in bits.c:1826\nIt seems due to the incomplete fix of #126-3.\nPoC: https://github.com/strongcourage/PoCs/blob/master/libredwg_b0b41f5/PoC_hbo_bits.c:1826\nASAN says:\n~~~\n==28015==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x62a0000057cd at pc 0x7f3c50b90145 bp 0x7ffd882ff990 sp 0x7ffd882ff980\nREAD of size 1 at 0x62a0000057cd thread T0\n    #0 0x7f3c50b90144 in bit_calc_CRC ../../src/bits.c:1826\n    #1 0x7f3c50c08c4d in decode_R13_R2000 ../../src/decode.c:932\n    #2 0x7f3c50b910d8 in dwg_decode ../../src/decode.c:220\n    #3 0x7f3c50b81d78 in dwg_read_file ../../src/dwg.c:193\n    #4 0x4019b5 in test_SVG ../../examples/dwg2svg2.c:119\n    #5 0x404809 in main ../../examples/dwg2svg2.c:505\n    #6 0x7f3c503d982f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n    #7 0x4017e8 in _start (/home/dungnguyen/PoCs/libredwg_1406432/.libs/lt-dwg2svg2+0x4017e8)\n~~~","files":null},{"type":3,"author":{"id":"1b887fa524848596ba06633285df999b53626bc3"},"timestamp":1564329005,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUxNTc3MzU1MQ==","github-url":"https://github.com/LibreDWG/libredwg/issues/126#issuecomment-515773551"},"message":"#### 10. HBO in bits.c:294 (#126-8)\nPoC: https://github.com/strongcourage/PoCs/blob/master/libredwg_b0b41f5/PoC_hbo_bits.c:294\nASAN says:\n~~~\nREAD of size 1 at 0x62c00000f600 thread T0\n    #0 0x7f8f79459367 in bit_read_RC ../../src/bits.c:294\n    #1 0x7f8f7945a75f in bit_read_H ../../src/bits.c:1120\n    #2 0x7f8f7946b2a3 in dwg_decode_handleref_with_code ../../src/decode.c:3237\n    #3 0x7f8f7954736b in dwg_decode_BLOCK_CONTROL_private ../../src/dwg.spec:2310\n    #4 0x7f8f7965072c in dwg_decode_BLOCK_CONTROL ../../src/dwg.spec:2300\n    #5 0x7f8f796c373d in dwg_decode_add_object ../../src/decode.c:4182\n    #6 0x7f8f796c9823 in read_2004_section_handles ../../src/decode.c:2270\n    #7 0x7f8f796c9823 in decode_R2004 ../../src/decode.c:2445\n    #8 0x7f8f796d195c in dwg_decode ../../src/decode.c:226\n    #9 0x7f8f7945387a in dwg_read_file ../../src/dwg.c:193\n    #10 0x4019b5 in test_SVG ../../examples/dwg2svg2.c:119\n    #11 0x404809 in main ../../examples/dwg2svg2.c:505\n    #12 0x7f8f78c1582f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n    #13 0x4017e8 in _start (/home/dungnguyen/PoCs/libredwg_b0b41f5/.libs/lt-dwg2svg2+0x4017e8)\n~~~","files":null},{"type":3,"author":{"id":"1b887fa524848596ba06633285df999b53626bc3"},"timestamp":1564329129,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUxNTc3MzcwMA==","github-url":"https://github.com/LibreDWG/libredwg/issues/126#issuecomment-515773700"},"message":"#### 11. HBO in decode.c:1589 (#126-4)\nPoC: https://github.com/strongcourage/PoCs/blob/master/libredwg_b0b41f5/PoC_hbo_decode.c:1579\nASAN says:\n~~~\n==1662==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x62c00000f600 at pc 0x7fb6378b710d bp 0x7ffebbc956b0 sp 0x7ffebbc956a0\nWRITE of size 1 at 0x62c00000f600 thread T0\n    #0 0x7fb6378b710c in decompress_R2004_section ../../src/decode.c:1589\n    #1 0x7fb6378b817c in read_2004_compressed_section ../../src/decode.c:1986\n    #2 0x7fb637b1c6a2 in read_2004_section_handles ../../src/decode.c:2207\n    #3 0x7fb637b1c6a2 in decode_R2004 ../../src/decode.c:2445\n    #4 0x7fb637b2495c in dwg_decode ../../src/decode.c:226\n    #5 0x7fb6378a687a in dwg_read_file ../../src/dwg.c:193\n    #6 0x4019b5 in test_SVG ../../examples/dwg2svg2.c:119\n    #7 0x404809 in main ../../examples/dwg2svg2.c:505\n    #8 0x7fb63706882f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n    #9 0x4017e8 in _start (/home/dungnguyen/PoCs/libredwg_b0b41f5/.libs/lt-dwg2svg2+0x4017e8)\n~~~","files":null},{"type":3,"author":{"id":"1b887fa524848596ba06633285df999b53626bc3"},"timestamp":1564332287,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUxNTc3NzI4OQ==","github-url":"https://github.com/LibreDWG/libredwg/issues/126#issuecomment-515777289"},"message":"#### 12.  SBO in dwg.c:1175 (#126-6)\nPoC: https://github.com/strongcourage/PoCs/blob/master/libredwg_b0b41f5/PoC_sbo_dwg.c:1175\nASAN says:\n~~~\n==19015==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7ffd8372b1b8 at pc 0x7f88b65b6e6a bp 0x7ffd8372b170 sp 0x7ffd8372b160\nWRITE of size 1 at 0x7ffd8372b1b8 thread T0\n    #0 0x7f88b65b6e69 in dwg_section_type ../../src/dwg.c:1175\n    #1 0x7f88b684e749 in read_sections_map ../../src/decode_r2007.c:893\n    #2 0x7f88b684e749 in read_r2007_meta_data ../../src/decode_r2007.c:1684\n    #3 0x7f88b6831767 in decode_R2007 ../../src/decode.c:2483\n    #4 0x7f88b6831767 in dwg_decode ../../src/decode.c:222\n    #5 0x7f88b65b287a in dwg_read_file ../../src/dwg.c:193\n    #6 0x4019b5 in test_SVG ../../examples/dwg2svg2.c:119\n    #7 0x404809 in main ../../examples/dwg2svg2.c:505\n    #8 0x7f88b5d7482f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n    #9 0x4017e8 in _start (/home/dungnguyen/PoCs/libredwg_b0b41f5/.libs/lt-dwg2svg2+0x4017e8)\n~~~","files":null},{"type":3,"author":{"id":"1b887fa524848596ba06633285df999b53626bc3"},"timestamp":1564332369,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUxNTc3NzQwNQ==","github-url":"https://github.com/LibreDWG/libredwg/issues/126#issuecomment-515777405"},"message":"#### 13. SEGV in dwg2svg2.c:258\nPoC: https://github.com/strongcourage/PoCs/blob/master/libredwg_b0b41f5/PoC_segv_dwg2svg2.c:261\nASAN says:\n~~~\n==19095==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000018 (pc 0x0000004031c3 bp 0x7ffd061fbd80 sp 0x7ffd061fbbc0 T0)\n    #0 0x4031c2 in output_INSERT ../../examples/dwg2svg2.c:258\n    #1 0x4036d8 in output_object ../../examples/dwg2svg2.c:289\n    #2 0x403b1a in output_BLOCK_HEADER ../../examples/dwg2svg2.c:350\n    #3 0x4040bd in output_SVG ../../examples/dwg2svg2.c:403\n    #4 0x4019c8 in test_SVG ../../examples/dwg2svg2.c:121\n    #5 0x404809 in main ../../examples/dwg2svg2.c:505\n    #6 0x7fe94f02682f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n    #7 0x4017e8 in _start (/home/dungnguyen/PoCs/libredwg_b0b41f5/.libs/lt-dwg2svg2+0x4017e8)\n~~~","files":null},{"type":3,"author":{"id":"1b887fa524848596ba06633285df999b53626bc3"},"timestamp":1564332432,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUxNTc3NzQ5MA==","github-url":"https://github.com/LibreDWG/libredwg/issues/126#issuecomment-515777490"},"message":"#### 14. SEGV in free.c:820\nPoC: https://github.com/strongcourage/PoCs/blob/master/libredwg_b0b41f5/PoC_segv_free.c:820\nASAN says:\n~~~\n==19179==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000008 (pc 0x7f15d5c3ee69 bp 0x7fffd4b9f0b0 sp 0x7fffd4b9f060 T0)\n    #0 0x7f15d5c3ee68 in dwg_free ../../src/free.c:820\n    #1 0x4019d2 in test_SVG ../../examples/dwg2svg2.c:123\n    #2 0x404809 in main ../../examples/dwg2svg2.c:505\n    #3 0x7f15d50ce82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n    #4 0x4017e8 in _start (/home/dungnguyen/PoCs/libredwg_b0b41f5/.libs/lt-dwg2svg2+0x4017e8)\n~~~","files":null},{"type":3,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1564334841,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUxNTc4MDI1Mg==","github-url":"https://github.com/LibreDWG/libredwg/issues/126#issuecomment-515780252"},"message":"As of 9ca3760a we have now the hbo of part 10 BLOCK_CONTROL.block_headers, \nand a msan leak of part 14 (read_2004_compressed_section decode.c:1961:26)","files":null},{"type":6,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1564334841,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdDI1NTU0NTA1MQ=="},"target":"41ccf83717b856c98db8a284c2e51c36eccb4028d49e70683e57320f635cce28","message":"As of 9ca3760a we have now the hbo of part 10 BLOCK_CONTROL.block_headers, \nand a msan leak of part 14 (read_2004_compressed_section decode.c:1961:26 decomp)","files":null},{"type":6,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1564389390,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdDI1NTczNjM5NQ=="},"target":"41ccf83717b856c98db8a284c2e51c36eccb4028d49e70683e57320f635cce28","message":"As of 9ca3760a we now have only the hbo of part 10 BLOCK_CONTROL.block_headers, \nand a msan leak of part 14 (read_2004_compressed_section decode.c:1961:26 decomp).\n\nBut I found a couple more problems by my own.","files":null},{"type":6,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1564680972,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdDI1Nzg5Mjc5MA=="},"target":"41ccf83717b856c98db8a284c2e51c36eccb4028d49e70683e57320f635cce28","message":"As of 9ca3760a we now have only the hbo of part 10 BLOCK_CONTROL.block_headers, \nand a msan leak of part 14 (read_2004_compressed_section decode.c:1961:26 decomp).\n\nBut I found a couple more problems by my own.\n\nThe remaining bugs are all related to a not-yet restricted hdl_dat stream, leading to unbounded HANDLE_VECTOR overflows (handled in GH #85), (and similar) \nand the strange leak. Closing.","files":null},{"type":3,"author":{"id":"1b887fa524848596ba06633285df999b53626bc3"},"timestamp":1564479500,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUxNjM0NTM2MA==","github-url":"https://github.com/LibreDWG/libredwg/issues/126#issuecomment-516345360"},"message":"Thanks for your patches on master. The latest commit bc7d9e0 fixed almost bugs. When running the latest commit with old crashing inputs, there are still following bugs that you could be interested to fix.\n#### 15. HBO in bits.c:1826\nPoC: https://github.com/strongcourage/PoCs/blob/master/libredwg_bc7d9e0/PoC_hbo_bits.c:1826\n~~~\n==17965==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x62a00000567f at pc 0x7f866c5a5d87 bp 0x7ffe9d426d20 sp 0x7ffe9d426d10\nREAD of size 1 at 0x62a00000567f thread T0\n    #0 0x7f866c5a5d86 in bit_calc_CRC ../../src/bits.c:1826\n    #1 0x7f866c8231ab in decode_R13_R2000 ../../src/decode.c:1062\n    #2 0x7f866c8231ab in dwg_decode ../../src/decode.c:225\n    #3 0x7f866c59a97a in dwg_read_file ../../src/dwg.c:193\n    #4 0x401c2e in test_SVG ../../examples/dwg2svg2.c:119\n    #5 0x401c2e in main ../../examples/dwg2svg2.c:506\n    #6 0x7f866bd5c82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n    #7 0x402038 in _start (/home/dungnguyen/PoCs/libredwg_bc7d9e0/.libs/lt-dwg2svg2+0x402038)\n~~~\n\n#### 16. HBO in bits.c:294\nPoC: https://github.com/strongcourage/PoCs/blob/master/libredwg_bc7d9e0/PoC_hbo_bits.c:294\n~~~\n==18087==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x62c00000f600 at pc 0x7f94e96cc468 bp 0x7ffcab733b70 sp 0x7ffcab733b60\nREAD of size 1 at 0x62c00000f600 thread T0\n    #0 0x7f94e96cc467 in bit_read_RC ../../src/bits.c:294\n    #1 0x7f94e96cd85f in bit_read_H ../../src/bits.c:1120\n    #2 0x7f94e96de493 in dwg_decode_handleref_with_code ../../src/decode.c:3283\n    #3 0x7f94e97f791b in dwg_decode_VPORT_CONTROL_private ../../src/dwg.spec:2848\n    #4 0x7f94e9938d0c in dwg_decode_VPORT_CONTROL ../../src/dwg.spec:2839\n    #5 0x7f94e9938d0c in dwg_decode_add_object ../../src/decode.c:4302\n    #6 0x7f94e993cae3 in read_2004_section_handles ../../src/decode.c:2316\n    #7 0x7f94e993cae3 in decode_R2004 ../../src/decode.c:2491\n    #8 0x7f94e9944e74 in dwg_decode ../../src/decode.c:231\n    #9 0x7f94e96c697a in dwg_read_file ../../src/dwg.c:193\n    #10 0x401c2e in test_SVG ../../examples/dwg2svg2.c:119\n    #11 0x401c2e in main ../../examples/dwg2svg2.c:506\n    #12 0x7f94e8e8882f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n    #13 0x402038 in _start (/home/dungnguyen/PoCs/libredwg_bc7d9e0/.libs/lt-dwg2svg2+0x402038)\n~~~ \n\n#### 17. HBO in decode.c:1668\nPoC: https://github.com/strongcourage/PoCs/blob/master/libredwg_bc7d9e0/PoC_hbo_decode.c:1668\n~~~\n==18106==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x61900000b8f8 at pc 0x7f6f4f7d5fe4 bp 0x7fff288a1220 sp 0x7fff288a1210\nREAD of size 8 at 0x61900000b8f8 thread T0\n    #0 0x7f6f4f7d5fe3 in read_R2004_section_map ../../src/decode.c:1668\n    #1 0x7f6f4f7d5fe3 in decode_R2004 ../../src/decode.c:2451\n    #2 0x7f6f4f7d6e74 in dwg_decode ../../src/decode.c:231\n    #3 0x7f6f4f55897a in dwg_read_file ../../src/dwg.c:193\n    #4 0x401c2e in test_SVG ../../examples/dwg2svg2.c:119\n    #5 0x401c2e in main ../../examples/dwg2svg2.c:506\n    #6 0x7f6f4ed1a82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n    #7 0x402038 in _start (/home/dungnguyen/PoCs/libredwg_bc7d9e0/.libs/lt-dwg2svg2+0x402038)\n~~~\n\n#### 18. SEGV in bits.c:295\nPoC: https://github.com/strongcourage/PoCs/blob/master/libredwg_bc7d9e0/PoC_segv_bits.c:295\n~~~\n==18130==ERROR: AddressSanitizer: SEGV on unknown address 0x7fcaf3a87bdd (pc 0x7fcaf23173a9 bp 0x7ffee9a73d20 sp 0x7ffee9a73d10 T0)\n    #0 0x7fcaf23173a8 in bit_read_RC ../../src/bits.c:295\n    #1 0x7fcaf231885f in bit_read_H ../../src/bits.c:1120\n    #2 0x7fcaf2329493 in dwg_decode_handleref_with_code ../../src/decode.c:3283\n    #3 0x7fcaf2488adb in dwg_decode_LAYOUT_private ../../src/dwg.spec:3899\n    #4 0x7fcaf255becc in dwg_decode_LAYOUT ../../src/dwg.spec:3842\n    #5 0x7fcaf2584bbe in dwg_decode_add_object ../../src/decode.c:4391\n    #6 0x7fcaf2587ae3 in read_2004_section_handles ../../src/decode.c:2316\n    #7 0x7fcaf2587ae3 in decode_R2004 ../../src/decode.c:2491\n    #8 0x7fcaf258fe74 in dwg_decode ../../src/decode.c:231\n    #9 0x7fcaf231197a in dwg_read_file ../../src/dwg.c:193\n    #10 0x401c2e in test_SVG ../../examples/dwg2svg2.c:119\n    #11 0x401c2e in main ../../examples/dwg2svg2.c:506\n    #12 0x7fcaf1ad382f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n    #13 0x402038 in _start (/home/dungnguyen/PoCs/libredwg_bc7d9e0/.libs/lt-dwg2svg2+0x402038)\n~~~","files":null},{"type":3,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1564563256,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUxNjc2MDIxOQ==","github-url":"https://github.com/LibreDWG/libredwg/issues/126#issuecomment-516760219"},"message":"16 and 18 not so far. This requires the gh85-common branch, with stricter hdl_dat sizes.\nThe others are on my radar, but I got a couple of hundreds more, which are not that interesting and realistic yet.\nI'll rather finish the importers first.","files":null},{"type":4,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1564680974,"metadata":{"github-id":"MDExOkNsb3NlZEV2ZW50MjUyNzM0NDA4Nw=="},"status":2}]}