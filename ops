{"version":1,"ops":[{"type":1,"author":{"id":"adf43da3a2a0f02dbfb5a8bdfc874e2af71e656d"},"timestamp":1562177732,"metadata":{"github-id":"MDU6SXNzdWU0NjM4OTAzNjM=","github-url":"https://github.com/LibreDWG/libredwg/issues/113","origin":"github"},"title":"Access violation when freeing MULTILEADER","message":"The MULTILEADER will create access violation when freeing object if 'ctx.has_content_block' is set since it will always free the ctx.content.txt.style handle (which is a union with ctx.content.blk).\n\nThe fix is (in dwg.spec):\n\n1) Comment out the line (all handles are read from the handle stream):\n   FIELD_HANDLE (ctx.content.blk.block_table, 4, 341); \n2) Change the line:\n  FIELD_HANDLE (ctx.content.txt.style, 5, 340);\nto\n  if (FIELD_VALUE (ctx.has_content)) {\n      FIELD_HANDLE (ctx.content.txt.style, 5, 340);\n  } else if (FIELD_VALUE (ctx.has_content_block)) {\n      FIELD_HANDLE (ctx.content.blk.block_table, 4, 341);\n  }\n\nThe attached file has a multileader with a block content\n\n[ACI 20160321 A 30 east.zip]\n(https://github.com/LibreDWG/libredwg/files/3356330/ACI.20160321.A.30.east.zip)","files":null}]}