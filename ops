{"version":1,"ops":[{"type":1,"author":{"id":"92d786e78a13918866d6b1068d3f0983fe3b982d"},"timestamp":1578883782,"metadata":{"github-id":"MDU6SXNzdWU1NDg2NzQ3NTA=","github-url":"https://github.com/LibreDWG/libredwg/issues/183","origin":"github"},"title":"Heap over flow","message":"I found a bug in dwg2dxf.\nPOC: https://github.com/linhlhq/research/blob/master/PoCs/libreDWG_69b5609/id:000000%2Csig:06%2Csrc:000001%2Cop:flip4%2Cpos:27167\n```\n==29243==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x6140000005b2 at pc 0x7ffafa9dc77a bp 0x7ffcc19b07e0 sp 0x7ffcc19aff88\nWRITE of size 126 at 0x6140000005b2 thread T0\n    #0 0x7ffafa9dc779  (/usr/lib/x86_64-linux-gnu/libasan.so.4+0x79779)\n    #1 0x561777b62e9c in memcpy /usr/include/x86_64-linux-gnu/bits/string_fortified.h:34\n    #2 0x561777b62e9c in read_2004_compressed_section ../../src/decode.c:2379\n    #3 0x56177811f8af in read_2004_section_preview ../../src/decode.c:2778\n    #4 0x56177811f8af in decode_R2004 ../../src/decode.c:2965\n    #5 0x56177812c264 in dwg_decode ../../src/decode.c:245\n    #6 0x561777adb7c2 in dwg_read_file ../../src/dwg.c:211\n    #7 0x561777ad9550 in main ../../programs/dwg2dxf.c:255\n    #8 0x7ffafa1f5b96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)\n    #9 0x561777adaa69 in _start (/home/user/linhlhq/libredwg/asan_build/programs/dwg2dxf+0x363a69)\n\nAddress 0x6140000005b2 is a wild pointer.\nSUMMARY: AddressSanitizer: heap-buffer-overflow (/usr/lib/x86_64-linux-gnu/libasan.so.4+0x79779)\nShadow bytes around the buggy address:\n  0x0c287fff8060: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c287fff8070: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c287fff8080: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c287fff8090: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c287fff80a0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n=\u003e0x0c287fff80b0: fa fa fa fa fa fa[fa]fa fa fa fa fa fa fa fa fa\n  0x0c287fff80c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c287fff80d0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c287fff80e0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c287fff80f0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c287fff8100: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07\n  Heap left redzone:       fa\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n==29243==ABORTING\n```","files":null}]}