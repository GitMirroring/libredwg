{"version":1,"ops":[{"type":6,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1567947992,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdDI3NDk2OTIzOA=="},"target":"748cbfec599cc951964a2a552463a2a8f2a6374f8bfacf67bd4ca9efa537b936","message":"with -O2 and inlining or loop-unrolling restrict is broken since gcc 5 and clang ?.\nin clang bug added with llvm r305938\nhttps://github.com/rust-lang/rust/issues/54878\n\nAdd a m4 probe and undefine it then.","files":null},{"type":6,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1567948102,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdDI3NDk2OTM4NQ=="},"target":"748cbfec599cc951964a2a552463a2a8f2a6374f8bfacf67bd4ca9efa537b936","message":"with -O2 and inlining or loop-unrolling restrict is broken since gcc 5 and clang ?.\nin clang bug added with llvm r305938\nhttps://github.com/rust-lang/rust/issues/54878\nhttps://bugs.llvm.org/show_bug.cgi?id=39282\nhttps://gcc.gnu.org/bugzilla/show_bug.cgi?id=87609\n\nAdd a m4 probe and undefine it then.","files":null},{"type":6,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1567952681,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdDI3NDk3ODI0NQ=="},"target":"748cbfec599cc951964a2a552463a2a8f2a6374f8bfacf67bd4ca9efa537b936","message":"with -O2 and inlining or loop-unrolling restrict is broken since gcc 5 and clang 6 until now.\n\nin clang bug added with llvm r305938\nhttps://github.com/rust-lang/rust/issues/54878\nhttps://bugs.llvm.org/show_bug.cgi?id=39282\nhttps://gcc.gnu.org/bugzilla/show_bug.cgi?id=87609\n\nAdd a m4 probe and undefine it then.","files":null},{"type":5,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1567947959,"metadata":{"github-id":"MDEyOkxhYmVsZWRFdmVudDI2MTY3NDkzMTQ="},"added":["bug"],"removed":[]},{"type":2,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1567948636,"metadata":{"github-id":"MDE3OlJlbmFtZWRUaXRsZUV2ZW50MjYxNjc1NDgzMg=="},"title":"probe for broken restrict","was":"probe for broken restrict"},{"type":3,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1567949655,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUyOTIwMzM5MA==","github-url":"https://github.com/LibreDWG/libredwg/issues/141#issuecomment-529203390"},"message":"Something like this:\n```\nAC_DEFUN([AX_RESTRICT],\n[\nAC_CACHE_CHECK([for restrict usability], [ax_cv_restrict_usable], [\nAC_COMPILE_IFELSE([AC_LANG_PROGRAM([[\n#include \"stdio.h\"\nvoid copy(int * restrict to, int * restrict from) {\n\t*to = *from;\n}\nvoid test(int *a, int *b) {\n\tfor (int i = 0; i \u003c 4; i++) {\n\t\tcopy(\u0026b[i \u0026 1], \u0026a[i \u0026 1]);\n\t}\n}\nint main() {\n\tint ary[] = {0, 1, 2};\n\ttest(\u0026ary[1], \u0026ary[0]);\n\t#printf(\"%d %d %d\\n\", ary[0], ary[1], ary[2]);\n\treturn ary[0] == 2;\n}\n# 2 2 2 is correct\n# 1 2 2 wrong\n]], [[ax_cv_restrict_usable=restrict]], [[ax_cv_restrict_usable=]])])\n])\n    if test -z $ax_cv_restrict_usable; then\n      AC_MSG_RESULT([no])\n      AC_DEFINE_UNQUOTED(restrict, $ax_cv_restrict_usable, [If restrict is usable with this compiler])\n    else\n      AC_MSG_RESULT([yes])\n    fi\n]) dnl AX_RESTRICT\n```","files":null},{"type":6,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1567949655,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdDI3NDk3MjU1Mw=="},"target":"65b09a798d72bc490bc9f5f1c10dc089d34a51f9de5cc6546411f2f6e6c9ec2c","message":"Something like this:\n```\nAC_DEFUN([AX_RESTRICT],\n[\nAC_CACHE_CHECK([for restrict usability], [ax_cv_restrict_usable], [\nAC_COMPILE_IFELSE([AC_LANG_PROGRAM([[\nvoid copy(int * restrict to, int * restrict from) {\n\t*to = *from;\n}\nvoid test(int *a, int *b) {\n\tfor (int i = 0; i \u003c 4; i++) {\n\t\tcopy(\u0026b[i \u0026 1], \u0026a[i \u0026 1]);\n\t}\n}\nint main() {\n\tint ary[] = {0, 1, 2};\n\ttest(\u0026ary[1], \u0026ary[0]);\n\t#printf(\"%d %d %d\\n\", ary[0], ary[1], ary[2]);\n\treturn ary[0] == 2;\n}\n# 2 2 2 is correct\n# 1 2 2 wrong\n]], [[ax_cv_restrict_usable=restrict]], [[ax_cv_restrict_usable=]])])\n])\n    if test -z $ax_cv_restrict_usable; then\n      AC_MSG_RESULT([no])\n      AC_DEFINE_UNQUOTED(restrict, $ax_cv_restrict_usable, [If restrict is usable with this compiler])\n    else\n      AC_MSG_RESULT([yes])\n    fi\n]) dnl AX_RESTRICT\n```","files":null},{"type":3,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1568014519,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUyOTMzNzQ3NA==","github-url":"https://github.com/LibreDWG/libredwg/issues/141#issuecomment-529337474"},"message":"For now I disabled it, as I don't trust the restrict check (e.g. gcc-8 passes), but removed restrict from two suspicious candidate functions in decode_r2007. copy_bytes_2, copy_bytes_3.","files":null},{"type":4,"author":{"id":"b57a4f5420adf835b8b83469143e813bd4f12c78"},"timestamp":1568014519,"metadata":{"github-id":"MDExOkNsb3NlZEV2ZW50MjYxNzY1ODU0NA=="},"status":2}]}