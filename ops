{"version":1,"ops":[{"type":1,"author":{"id":"2bf6b52bc0dae630473aacf6f181bed209a5a6b2"},"timestamp":1571999491,"metadata":{"github-id":"MDU6SXNzdWU1MTI0MzY5MTk=","github-url":"https://github.com/LibreDWG/libredwg/issues/164","origin":"github"},"title":"heap overflow in libredwg 0.9.2400","message":"ASAN output\n```\n~/workplace/asan/libredwg-0.9.2400/examples/.libs$ cp /home/xxx/coding/secdive/bin/hfl/output/dwg2svg2-D176DC154C7584796D83112A93FE173E/hfl-crash-1-heap_overflow-rva_0xCB9CA-code_0xB-libredwg.so.0 libredwg2400-heapoverflow.dwg\nxxx@secdive-public-dev:~/workplace/asan/libredwg-0.9.2400/examples/.libs$ ./dwg2svg2 libredwg2400-heapoverflow.dwg \n=================================================================\n==8024== ERROR: AddressSanitizer: heap-buffer-overflow on address 0x608400009f08 at pc 0x7eff9f8b1cff bp 0x7fff8d03e860 sp 0x7fff8d03e858\nREAD of size 1 at 0x608400009f08 thread T0\n    #0 0x7eff9f8b1cfe (/home/xxx/workplace/asan/libredwg-0.9.2400/src/.libs/libredwg.so.0.0.9+0x120cfe)\n    #1 0x7eff9f9486b8 (/home/xxx/workplace/asan/libredwg-0.9.2400/src/.libs/libredwg.so.0.0.9+0x1b76b8)\n    #2 0x7eff9f8b2e4b (/home/xxx/workplace/asan/libredwg-0.9.2400/src/.libs/libredwg.so.0.0.9+0x121e4b)\n    #3 0x7eff9f89df05 (/home/xxx/workplace/asan/libredwg-0.9.2400/src/.libs/libredwg.so.0.0.9+0x10cf05)\n    #4 0x40192b (/home/xxx/workplace/asan/libredwg-0.9.2400/examples/.libs/dwg2svg2+0x40192b)\n    #5 0x403f0c (/home/xxx/workplace/asan/libredwg-0.9.2400/examples/.libs/dwg2svg2+0x403f0c)\n    #6 0x7eff9f0e3f44 (/lib/x86_64-linux-gnu/libc-2.19.so+0x21f44)\n    #7 0x401698 (/home/xxx/workplace/asan/libredwg-0.9.2400/examples/.libs/dwg2svg2+0x401698)\n0x608400009f08 is located 0 bytes to the right of 19720-byte region [0x608400005200,0x608400009f08)\nallocated by thread T0 here:\n    #0 0x7effa0be34e5 (/usr/lib/x86_64-linux-gnu/libasan.so.0.0.0+0x154e5)\n    #1 0x7eff9f89d1f2 (/home/xxx/workplace/asan/libredwg-0.9.2400/src/.libs/libredwg.so.0.0.9+0x10c1f2)\n    #2 0x7eff9f89dec3 (/home/xxx/workplace/asan/libredwg-0.9.2400/src/.libs/libredwg.so.0.0.9+0x10cec3)\n    #3 0x40192b (/home/xxx/workplace/asan/libredwg-0.9.2400/examples/.libs/dwg2svg2+0x40192b)\n    #4 0x403f0c (/home/xxx/workplace/asan/libredwg-0.9.2400/examples/.libs/dwg2svg2+0x403f0c)\n    #5 0x7eff9f0e3f44 (/lib/x86_64-linux-gnu/libc-2.19.so+0x21f44)\nShadow bytes around the buggy address:\n  0x0c10ffff9390: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c10ffff93a0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c10ffff93b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c10ffff93c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c10ffff93d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n=\u003e0x0c10ffff93e0: 00[fa]fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c10ffff93f0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c10ffff9400: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c10ffff9410: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c10ffff9420: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c10ffff9430: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07 \n  Heap left redzone:     fa\n  Heap righ redzone:     fb\n  Freed Heap region:     fd\n  Stack left redzone:    f1\n  Stack mid redzone:     f2\n  Stack right redzone:   f3\n  Stack partial redzone: f4\n  Stack after return:    f5\n  Stack use after scope: f8\n  Global redzone:        f9\n  Global init order:     f6\n  Poisoned by user:      f7\n  ASan internal:         fe\n==8024== ABORTING\n\n```\n\npoc\n```\nhttps://github.com/hac425xxx/fuzzdata/blob/master/libredwg2400-heapoverflow.dwg\n```","files":null}]}