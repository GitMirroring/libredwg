{"version":1,"ops":[{"type":1,"author":{"id":"92d786e78a13918866d6b1068d3f0983fe3b982d"},"timestamp":1579063079,"metadata":{"github-id":"MDU6SXNzdWU1NDk5NjEyMjQ=","github-url":"https://github.com/LibreDWG/libredwg/issues/188","origin":"github"},"title":"Several bugs found by fuzzing","message":"Hi,\nAfter fuzzing libredwg, I found the following bugs on the latest commit on master.\nCommand: ./dwgbmp $PoC\n\n**1.NULL pointer dereference in read_2004_compressed_section ../../src/decode.c:2417**\nPOC: https://github.com/linhlhq/research/blob/master/PoCs/libreDWG_4c26d37/id:000012%2Csig:06%2Csrc:002489%2Cop:havoc%2Crep:16\n```\n=================================================================\n==20486==ERROR: AddressSanitizer: SEGV on unknown address 0x62904165558b (pc 0x7fa1bce115c5 bp 0x7fff8e06b350 sp 0x7fff8e06aab8 T0)\n==20486==The signal is caused by a READ memory access.\n    #0 0x7fa1bce115c4  (/lib/x86_64-linux-gnu/libc.so.6+0xbb5c4)\n    #1 0x7fa1bd55e6ce  (/usr/lib/x86_64-linux-gnu/libasan.so.4+0x796ce)\n    #2 0x5634364fc7b6 in memcpy /usr/include/x86_64-linux-gnu/bits/string_fortified.h:34\n    #3 0x5634364fc7b6 in read_2004_compressed_section ../../src/decode.c:2417\n    #4 0x563436ac5dd2 in read_2004_section_summary ../../src/decode.c:2785\n    #5 0x563436ac5dd2 in decode_R2004 ../../src/decode.c:3352\n    #6 0x563436ad208d in dwg_decode ../../src/decode.c:246\n    #7 0x563436464fae in dwg_read_file ../../src/dwg.c:211\n    #8 0x5634364639d0 in get_bmp ../../programs/dwgbmp.c:111\n    #9 0x563436463066 in main ../../programs/dwgbmp.c:280\n    #10 0x7fa1bcd77b96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)\n    #11 0x5634364636c9 in _start (/home/user/linhlhq/libredwg/asan_build/programs/dwgbmp+0x28f6c9)\n\nAddressSanitizer can not provide additional info.\nSUMMARY: AddressSanitizer: SEGV (/lib/x86_64-linux-gnu/libc.so.6+0xbb5c4)\n```","files":null}]}